{% load static %}
{% include "Panel/header.html" %}
<style type="text/css"> 
	<!-- led indicator -->
	.led-box {
	  height: 15px;
	  width: 25%;
	  margin: 0px 0;
	  float: left;
	}
	.led-green {
	  margin: 0 auto;
	  width: 15px;
	  height: 15px;
	  background-color:  #ABFF00;
	  border-radius: 50%;
	  box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #304701 0 -1px 9px, #89FF00 0 2px 12px;
	}
	.led-box {
	  height: 15px;
	  width: 25%;
	  margin: 0px 0;
	  float: right;
	}
	.led-red {
		
	  margin: 0 auto;
	  width: 15px;
	  height: 15px;
	  background-color: #F00;
	  border-radius: 50%;
	  box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #441313 0 -1px 9px, rgba(255, 0, 0, 0.5) 0 2px 12px;
	}
	
	<!-- end led indicator -->


	.table-responsive {
		max-height:500px;
	}
	
	.table-bordered th , td , tr{
		border: 1px solid #000!important;
	}
	.table{
		width: 88% !important;
		table-layout: auto;
	}
	.table-bordered td{
		font-size: 12px;
	}
	.table-bordered th{
		font-size: 12px;
		padding: 4px;
	}
	.table-bordered td{
		
		padding: 3px;
	}
	.f-color{
		color: #000;
	}
	.green-bg{
		background-color: #79ee9b;
	}
	.red-bg{
		background-color: #ff5f5f;
	}
	.f-c-red{
		color: red;
	}
	.f-c-green{
		color: green;
	}
	.f-c-white{
		color: #fff;
	}
	.button-style{
		height: 140px !important; 
		border: 1px solid#000; 
		background-color:#ffd966; 
		width: 12%;
		border-left:hidden; 
		float:right;
	}
	.button-1{
		margin-bottom: 10px; 
		margin-left: 10px; 
		margin-top: 8px;
		background-color:white;
	}
	.button-2{
		margin-bottom: 10px; 
		margin-left: 10px;
		background-color:white;
	}
	.button-3{
		margin-left: 10px; 
		background-color:white;
	}
	.bg-1{
		background-color: #10b5f1;
	}
	.bg-2{
		background-color:#ffd966;
	}
	.bg-3{
		background-color: #d9e1f2;
	}
	.bg-4 {
		background-color:#92ddf9;
	}
	.bg-5{
		background-color:#ff4a4a;
	}
	.bg-6{
		background-color:#ffff96;
	}
	.bg-7{
		background-color:#c00000;
	}
	.bg-black{
		background-color:#000;
	}
	.darkred-bg{
		background-color:#ff0000;
	}
	.sl-bg{
		background-color:#febaac;
	} 
	.buy-bg{
		background-color:#305496;
	}
	.bg-yello{
		background-color: #ffc000;
	}
	.light-red{
		background-color:#fce4d6;
	}
	
	.table {
		width: 100% !important;
		table-layout: auto;
	}
	<!-- #log_div{ -->
		<!-- overflow: auto; -->
		<!-- white-space: nowrap; -->
	<!-- } -->
	<!-- #log_div div{ -->
		<!-- display: inline-block;	  -->
	<!-- } -->
	.app-main__inner{font-weight:750; color: black;}
	
	<!-- #history_log_table -->
	<!-- { -->
		<!-- border-collapse: collapse; -->
		<!-- border: 0; -->
	<!-- } -->
	<!-- #history_log_table th, td { -->
	  <!-- border: 1px solid #aaa; -->
	  <!-- background-clip: padding-box; -->
	  <!-- scroll-snap-align: start; -->
	  <!-- padding: 0.6rem; -->
	  <!-- min-width: 6rem; -->
	  <!-- text-align: left; -->
	  <!-- margin: 0; -->
	<!-- } -->
	<!-- #history_log_table tbody tr:last-child th, tbody tr:last-child td { -->
	  <!-- border-bottom: 0; -->
	<!-- } -->
	<!-- #history_log_table thead { -->
	  <!-- z-index: 1000; -->
	  <!-- position: relative; -->
	<!-- } -->
	<!-- #history_log_table thead th { -->
	  <!-- position: sticky; -->
	  <!-- top: 0; -->
	  <!-- border-top: 0; -->
	  <!-- background-clip: padding-box; -->
	<!-- } -->
	<!-- #history_log_table tbody th { -->
	  <!-- background-clip: padding-box; -->
	  <!-- border-left: 0; -->
	<!-- } -->
	<!-- #history_log_table tbody { -->
	  <!-- z-index: 10; -->
	  <!-- position: relative; -->
	<!-- } -->
	<!-- #history_log_table tbody th { -->
	  <!-- position: sticky; -->
	  <!-- left: 0; -->
	<!-- } -->
	<!-- #history_log_table thead th, -->
	<!-- tbody th { -->
	  <!-- background-color: #f8f8f8; -->
	<!-- } -->
	td{
		text-align: center;
	}
</style>
				<div class="app-main__inner" style="padding: 15px 0px 0 !important;">
					<!-- <div class="app-page-title"> -->
						<!-- <div class="page-title-wrapper"> -->
							<!-- <div class="page-title-heading"> -->
								<!-- <div class="page-title-icon"> -->
									<!-- <i class="pe-7s-graph icon-gradient bg-ripe-malin"></i> -->
								<!-- </div> -->
								<!-- <div>Nifty Dashboard -->
									<!-- <div class="page-title-subheading">This dashboard was created as an example of the flexibility that Architect offers.</div> -->
								<!-- </div> -->
							<!-- </div> -->
							<!-- <div class="page-title-actions"> -->
								<!-- <button type="button" data-toggle="tooltip" title="Example Tooltip" data-placement="bottom" -->
									<!-- class="btn-shadow mr-3 btn btn-dark"> -->
									<!-- <i class="fa fa-star"></i> -->
								<!-- </button> -->
								<!-- <div class="d-inline-block dropdown"> -->
									<!-- <button type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn-shadow dropdown-toggle btn btn-info"> -->
										<!-- <span class="btn-icon-wrapper pr-2 opacity-7"> -->
											<!-- <i class="fa fa-business-time fa-w-20"></i> -->
										<!-- </span> -->
										<!-- Buttons -->
									<!-- </button> -->
									<!-- <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right"> -->
										<!-- <ul class="nav flex-column"> -->
											<!-- <li class="nav-item"> -->
												<!-- <a class="nav-link"> -->
													<!-- <i class="nav-link-icon lnr-inbox"></i> -->
													<!-- <span> Inbox</span> -->
													<!-- <div class="ml-auto badge badge-pill badge-secondary">86</div> -->
												<!-- </a> -->
											<!-- </li> -->
											<!-- <li class="nav-item"> -->
												<!-- <a class="nav-link"> -->
													<!-- <i class="nav-link-icon lnr-book"></i> -->
													<!-- <span> Book</span> -->
													<!-- <div class="ml-auto badge badge-pill badge-danger">5</div> -->
												<!-- </a> -->
											<!-- </li> -->
											<!-- <li class="nav-item"> -->
												<!-- <a class="nav-link"> -->
													<!-- <i class="nav-link-icon lnr-picture"></i> -->
													<!-- <span> Picture</span> -->
												<!-- </a> -->
											<!-- </li> -->
											<!-- <li class="nav-item"> -->
												<!-- <a disabled class="nav-link disabled"> -->
													<!-- <i class="nav-link-icon lnr-file-empty"></i> -->
													<!-- <span> File Disabled</span> -->
												<!-- </a> -->
											<!-- </li> -->
										<!-- </ul> -->
									<!-- </div> -->
								<!-- </div> -->
							<!-- </div>		-->
												<!-- </div> -->
					<!-- </div>		  -->
<div class="tabs-animation">
						
<div class="col-lg-12" style="padding-right: 0px; padding-left: 0px;">
<row>
<!-- <ul class="nav nav-pills mt-3 ml-3" id="pills-tab" role="tablist" style="display: flex;justify-content: center;"> -->
  <!-- <li class="nav-item"> -->
	<!-- <a class="nav-link	 active " id="pills-nifty-tab" data-toggle="pill" href="#pills-nifty-dashboard" role="tab" aria-controls="pills-category" aria-selected="true">NIFTY DASHBOARD</a> -->
  <!-- </li> -->
  <!-- <li class="nav-item"> -->
	<!-- <a class="nav-link " id="pills-oi_analysis-tab" data-toggle="pill" href="#pills-oi_analysis_dashboard" role="tab" aria-controls="pills-merchant" aria-selected="false">OI ANALYSIS DASHBOARD</a> -->
  <!-- </li> -->
 <!-- </ul> -->


<div class="tab-content" id="pills-tabContent">
<div class="tab-pane fade  show active " id="pills-nifty-dashboard" role="tabpanel" aria-labelledby="pills-category-tab">
<div class="main-card card">
<div class="card-body" style="padding: 1rem !important;">
<h5 class="card-title">BANKNIFTY Dashboard</h5>
<!-- <div class="button-style">	 -->
	<!-- <button type="button" class="btn btn-primary f-c-green button-1">Start timer</button> -->
	<!-- <button type="button" class="btn btn-primary f-c-red button-2">Stop timer</button> -->
	<!-- <button type="button" class="btn btn-primary f-c-red button-3">Clear Data</button> -->
<!-- </div> -->
<table class="mb-0 table table-bordered" >
<thead>
	<tr class="text-center	">
		<th width="10%" class="f-color bg-1">SYMBOL</th>
		<th width="10%" class="f-color bg-1">Expiry Date</th>
		<th width="10%" class="f-c-red bg-2">Price</th>
		<th class="f-color bg-3">BANK NIFTY FUTURE</th>	
		<th width="10%" class="f-color bg-4">INDIA VIX</th>
		<th class="f-color bg-3">PCR</th>
		<th width="10%" class="f-color bg-4">Max Pain</th>
		<th colspan="2" class="f-color bg-2" width="25%">LTT Time</th>
		<!-- <th width="7%;" class="f-color bg-5">Time</th> -->
	</tr>
</thead>
<tbody >
	<tr class="text-center" >
		<td id="id_symbol" scope="row" class="f-c-red" width="10%">BANKNIFTY</td>
		<td id="id_expiry_date" width="10%" class="f-color" >
			<select aria-label="Default select example" id="id_expiry_date_select">
				{% for date in date_list %}
					<option value="{{date}}">{{date}}</option>
				{% endfor %}
			</select>
		</td>
		</td>
		<td id="id_price" width="10%" class="f-c-red">Waiting...</td>
		<td id="id_nifty_i" width="15%">Waiting...</td>
		<td id="id_india_vix" width="15%">Waiting...</td>
		<td id="id_pcr" width="20%" class="f-color">OVERBROUGHT</td>
		<td id="id_max_pain" width="15%"></td>
		<th id="id_last_update_time" colspan="4" width="7%" class="f-color" >19:27</th>
		<!-- <td id="id_time" width="7%" class="f-c-red bg-2"> -->
			
		</td>
	</tr>

	<tr class="text-center" >
		<th scope="row" style="border-right: hidden !important;" width="10%" ></th>
	</tr>
</tbody>

</table>

<!-- table 2 -->
<table class="mb-0 table table-bordered" style="border-top: hidden;">
	<thead>
	<tr class="text-center">
		<th colspan="5" class="f-color" style="background: #FDFD66;" width="25%">OHLC</th>
		<th colspan="5" width="7%" class="f-color bg-6">Support & Resistence</th>
		<th colspan="2" rowspan="2" style="background: #FDFD66;" width="5%" class="f-color">Reversal Time</th>
	</tr>
</thead>
<tbody>
	<tr class="text-center">
		<td	 width="11%" class="f-color">P.Close</td>
		<td	 width="11%" class="f-color">Open</td>
		<td	 width="5%" class="f-color">High</td>
		<td	 width="5%" class="f-color">Low</td>
		<td	 width="5%" class="f-color">% Change</td>
		<td	 width="5%" class="bg-7" style="color: white;">Pivot</td>

		<td	 width="4%" class="f-color green-bg">R1</td>
		<td	 width="4%" class="f-color green-bg" >R2</td>
		<td	 width="4%" class="f-color red-bg" >S1</td>
		<td	 width="4%" class="f-color red-bg"	>S2</td>

		<td id="id_reversal_time_1" rowspan="2" width="5%" class="f-c-red" >#value</td>
		<td id="id_reversal_time_2" rowspan="2" width="5%" class="f-c-red"	>#value</td>
	</tr>

	<tr class="text-center">
		<td id="id_pclose" width="5%" class="f-c-white bg-1"  >Waiting...</td>
		<td id="id_open"  width="5%" class="f-color" >Waiting...</td>
		<td id="id_high" width="5%" class="f-c-green">Waiting...</td>
		<td id="id_low"	 width="5%" class="f-c-red">waiting...</td>
		<td id="id_change"	width="5%" class="f-color">!Value</td>
		<td id="id_pivot" width="5%" class="f-color bg-1">!Value</td>


		<td id="id_r1" width="5%" class="bg-black" style="background: darkred; font-weight: 700; color:white;">#Value</td>
		<td id="id_r2" width="5%" class="bg-black" style="background: darkred;	font-weight: 700; color:white;">#Value</td>
		<td id="id_s1" width="5%" class="bg-black" style="background: darkgreen; font-weight: 700; color: lightgrey">#Value</td>
		<td id="id_s2" width="5%" class="bg-black" style="background: darkgreen; font-weight: 700; color: lightgrey;">#Value</td> 
	</tr>

</tbody>
	</table>

<!-- table 3 start -->
<table class="mb-0 table table-bordered" style=" width: 100% !important; margin-top: 20px;">
<tbody>
	<tr class="text-center">
		<th width="10%" class="f-color green-bg">Max OI</th>
		<th width="10%" class="f-color green-bg" >Call</th>
		<th width="10%" class="f-color red-bg" >Put</th>
		<th width="10%" class="f-color green-bg" >Max Change OI</th>
		<th width="10%" class="f-color green-bg" >Call</th>
		<th width="10%" class="f-color red-bg" >Put</th>
		<th colspan="" class="f-color bg-4" >Market Trend</th>
		<th colspan="2" class="f-color bg-6" >Strike</th>
		<th colspan="2" class="f-color bg-6" >PCR</th>
		<th colspan="3" class="f-color bg-6" >Net Change OI</th>
		

	</tr>


	<tr class="text-center f-color">
		<td class="green-bg">Strike Price</td>
		<td id="id_call_strike_price">#Value!</td>
		<td id="id_put_strike_price">#Value!</td>
		<td class="green-bg">Strike Price</td>
		<td id="id_call_change_strike_price">#Value!</td>
		<td id="id_put_change_strike_price">#Value!</td>
		<td rowspan="3" id="id_bull_bear" style="font-size: 18px; background: lightgreen;">BULLISH</td>
		<td id="id_strike_small_1" colspan="2">N/A</td>
		<td id="id_pcr_1" colspan="2">N/A</td>
		<td id="id_net_change_1" colspan="3">N/A</td>

	</tr>

	<tr class="text-center f-color">
		<td class="green-bg">Ol</td>
		<td id="id_call_oi">#Value!</td>
		 <td id="id_put_oi">#Value!</td>
		 <td class="green-bg">Ol</td>
		 <td id="id_call_change_oi">#Value!</td>
		 <td id="id_put_change_oi">#Value!</td>
		 <!-- <td colspan="" ></td> -->
		<td id="id_strike_small_2" colspan="2">N/A</td>
		<td id="id_pcr_2" colspan="2">N/A</td>
		<td id="id_net_change_2" colspan="3">N/A</td>
	 
		 
	</tr>
	<tr class="text-center f-color">
		<td class="green-bg">Volume</td>
		<td id="id_call_volume">#Value!</td>
		<td id="id_put_volume">#Value!</td>
		<td class="green-bg">Volume</td>
		<td id="id_call_change_volume">#Value!</td>
		<td id="id_put_change_volume">#Value!</td>
		<!-- <td colspan="" ></td> -->
		<td id="id_strike_small_3" colspan="2">N/A</td>
		<td id="id_pcr_3" colspan="2">N/A</td>
		<td id="id_net_change_3" colspan="3">N/A</td>
	</tr>

	<!-- Gann angle levels -->

	<tr class="text-center">
		<th	 rowspan="3" class="f-c-white darkred-bg">Gann Angle Levels</th>
		<th width="5%" colspan="1" class="f-color bg-2"></th>
		<th class="f-c-white bg-1">G-90&#176;</th>
		<th class="f-c-white bg-1">G-135&#176;</th>
		<th class="f-color sl-bg" width="2%;">G-45&#176;</th>
		
		
		<th rowspan="3" style="text-align: center; margin:0; padding:0; height:100%;">
			<div class="text-center" style="display: flex; flex-direction: row;">
				<div class="text-center" id="span1" style="margin-top: -20px;">
					<div class="text-center" style="width: 100%; padding-top: 10px; padding-left: 10px; padding-right:8px;   height: 100%;">
						<span style="font-size: 15px; color: red;">GENI</span>
					</div>
					<div class="text-center" style="width: 100%; margin-top: -22px; padding-left: 10px; padding-right: 8px; height: 90%;">
						<span style="font-size: 15px; color: red;">MODE</span>
					</div>
				</div>
				
				<div class="text-center" id="span2" style="">
					<div class="text-center" style="width: 100%; margin-top: -10px; margin-bottom: 8px; padding-left: 10px;  height: 100%;">
						<span id="id_geni_mode_logo">
							<img style=" width: 27px; height: 27px; " src="{% static 'Website/assets/images/Geni-icon01.png' %}">
							<!-- <img style=" width: 27px; height: 27px; " src="{% static 'Website/assets/images/geni-grey.png' %}"> -->
						</span>
						<span id="id_geni_mode_logo_off" style="display: none;">
							<!-- <img style=" width: 27px; height: 27px; " src="{% static 'Website/assets/images/Geni-icon01.png' %}"> -->
							<img style=" width: 27px; height: 27px; " src="{% static 'Website/assets/images/geni-grey.png' %}">
						</span>
					</div>
					<div class="text-center" style="width: 100%; margin-top: -13px; padding-left: 10px;">
						<span style="" id="id_geni_mode">ON</span>
					</div>
				</div>
			</div>
		</th>
		
		<th rowspan="3" style="text-align: center; margin:0; padding:0; height:100%;">
			<div style="display: flex; flex-direction: row;">
				<div id="span1" style="margin-top: -25px;">
					<div style="width: 100%; padding-top: 15px; padding-left: 10px; padding-right: 10px;  border-right: 1px solid black; height: 100%;">
						<span style="font-size: 15px;" id="id_buy_strike_price">strike</span>
					</div>
					<div  style="width: 100%; margin-top: -20px; border-right: 1px solid black; height: 80%;">
						<span id="id_ce_pe" style="font-size: 15px; color: red;">CE</span>
					</div>
				</div>
				
				<div id="span2" style="width: 100%;">
					<div style="width: 100%; margin-top: -10px; padding-left: 0	px;  height: 100%;">
						<span style="" id="id_buy_ltp_1">N/A</span>
					</div>
					<div  style="width: 100%; margin-top: -4px; padding-top: 7px; padding-left: 0px; border-top: 1px solid black;">
						<div id="id_led_box_2" class="led-box1" style="float: left; display: none;">
							<div class="led-red"></div>
						</div>
						<span id="id_buy_ltp_2">N/A</span>
						<div id="id_led_box" class="led-box" style="float: right; margin-top: 3px; display:none;">
							<div class="led-green"></div>
						</div>
					</div>
				</div>
			</div>
		</th>
		
		
		<td id="id_strike_small_4" colspan="2">N/A</td>
		<td id="id_pcr_4" colspan="2">N/A</td>
		<td id="id_net_change_4" colspan="3">N/A</td>
		<!-- <th class="f-c-white buy-bg" rowspan="2">BUY</th> -->
		<!-- <th id="id_buy_ce" class="f-c-green bg-black" width="5%" rowspan="2">1700 CE</th> -->
		<!-- <th id="id_buy_red" class="f-c-red" colspan="3" width="30%">125</th> -->
	</tr> 
	<tr class="text-center">
		<!-- <td class="f-c-green" width="3%">High </td> -->
		<!-- <td id="id_gann_high" class="f-color bg-yello">N/A</td> -->
		<td class="f-color green-bg">G-BULL</td>
		<td id="id_g_90_high" class="f-color" style=" background-color: #99f9b5;">N/A</td>
		<td id="id_g_135_high" class="f-color" style=" background-color: #50e97c;">N/A</td>
		<td id="id_g_45_high" class="f-c-red light-red" width="10%;">N/A</td>
		
		
		
		
		<!-- <td id="id_buy_green" class="f-c-green" colspan="3">165</td> -->
		<!-- <td class="f-color">Buy</td> -->
		<!-- <td class="f-color">Price</td> -->
		<!-- <td class="f-color">Target</td> -->
		<td id="id_strike_small_5" colspan="2">N/A</td>
		<td id="id_pcr_5" colspan="2">N/A</td>
		<td id="id_net_change_5" colspan="3">N/A</td>
 
	</tr>
	<tr class="text-center">
		
		<!-- <td class="f-c-red">Low</td> -->
		<!-- <td id="id_gann_low" class="f-color" style=" background-color:#ffc000;">N/A</td> -->
		<td class="f-color" style=" background-color:#ff4848; font-weight: 600;">G-BEAR</td>
		<td id="id_g_90_low" class="f-c-red" style=" background-color:#fce4d6;">N/A</td>
		<td id="id_g_135_low" class="f-color" style=" background-color:#50e97c;">N/A</td>
		<td id="id_g_45_low" class="f-c-red" style=" background-color:#fce4d6;">N/A</td>
		<!-- <th width="5%" colspan="2" class="f-color bg-2"></th> -->
		<!-- <td class="f-color" width="5%" style="background-color:red;">Time</td> -->
		<!-- <td class="f-color" width="10%">Time</td> -->
		<!-- <td class="f-color" colspan="3">Action</td> -->
		<!-- <td id="id_buy_ce_2" class="f-c-green" colspan="1" style= "background-color: #000;">17100 ce</td> -->
		<!-- <td id="id_price_ce" colspan="1"></td> -->
		<!-- <td id="id_target_ce" class="f-c-green" colspan="1">40</td> -->
		<td id="id_strike_small_6" colspan="2">N/A</td>
		<td id="id_pcr_6" colspan="2">N/A</td>
		<td id="id_net_change_6" colspan="3">N/A</td>
	</tr>
<!-- after genn level -->
	<tr class="text-center">
		 
		<td class="f-color" style="background-color:#ffff9c;">Select Strike Price</td>
		<td class="f-color" style=" background-color:#ffc000;">Strike Price</td>
		 
		<td class="f-color" colspan="2" width="11%" style="background-color:#90f9ae;">Call Change OI</td>
		<td class="f-color" colspan="2" width="11%" style="background-color:#ff5d4c;">Put Change OI</td>
		<td class="f-color bg-6" width="11%">LTP</td>
		<!-- <td id="id_buy_time" class="f-c-red" width="5%" style="background-color:#ffde7a;"> -->
			<!-- ddd -->
		<!-- </td> -->
		<!-- <td id="id_ce_time" class="f-color" colspan="3" ></td> -->
		<!-- <td id="id_action" class="f-c-red" width="11%"></td> -->
		<!-- <td class="f-color" colspan="1" style="background-color:#fc7f32;">Sentiment</td> -->
		<!-- <td class="f-c-green" colspan="2" rowspan="5"> -->
			<!-- <img style="width: 100px;" src="https://static.wixstatic.com/media/1be77a_c8320cb38c1e4e708dbef73aa90c0150~mv2.jpg/v1/fit/w_2500,h_1330,al_c/1be77a_c8320cb38c1e4e708dbef73aa90c0150~mv2.jpg"> -->
		 <!-- </td> -->

		<td id="id_strike_small_7" colspan="2">N/A</td>
		<td id="id_pcr_7" colspan="2">N/A</td>
		<td id="id_net_change_7" colspan="3">N/A</td>
		<!-- <td rowspan="5" colspan="4"  style=" color:red; background-color: #0070c0;">
			 
		<div style="height: 165px !important;border-left: hidden; float: right; display: inline-grid;"> 
	<button type="button" class="btn btn-primary" style="margin-bottom: 20px; margin-left: -80px; margin-top: 12px;background-color:white; color:green;">Start </button>
	<button type="button" class="btn btn-primary" style="margin-bottom: 20px; margin-left: -80px;background-color:white; color:red;">Stop</button>
	<button type="button" class="btn btn-primary" style="margin-left: -80px; background-color:white; color:red;">Clear</button>
</div>
		 </td> -->
  
	</tr>
  <tr class="text-center">
		
		<td id="id_enter_strike_price" class="f-color" style="background-color: #e2efda;">
			<select id="id_enter_strike_price_select">
				
			</select>
		</td>
		<td	 id="id_strike_price_1" class="f-color" style=" background-color: #d9d9d9;">#value</td> 
		<td id="id_call_chng_oi_1" class="f-c-green" colspan="2" style="background-color:#e2efda;">#N/A</td>
		<td id="id_put_chng_oi_1" class="f-c-red" colspan="2" style="background-color:#f8cbad;">#N/A</td>
		<td id="id_c_ltp_1" class="f-c-green">#N/A</td>	 
		<!-- <th class="f-c-red" colspan="2" width="11%" style="background-color:#d9e1f2;"> -->
		<!-- </th>	-->
		<!-- <td class="f-color" colspan="3">Action</td> -->
		<!-- <td class="f-color">Fll</td> -->
		<td id="id_strike_small_8" colspan="2">N/A</td>
		<td id="id_pcr_8" colspan="2">N/A</td>
		<td id="id_net_change_8" colspan="3">N/A</td>
	</tr>
	<tr class="text-center">
		
		<td class="f-color" rowspan="2" style="background-color:#8497b0;"></td>
		<td id="id_strike_price_2" class="f-color" style="background-color:#d9d9d9;">#value</td> 
		<td id="id_call_chng_oi_2" class="f-c-green" colspan="2" style="background-color:#e2efda;">#N/A</td>
		<td id="id_put_chng_oi_2" class="f-c-red" colspan="2" style="background-color: #f8cbad;">#N/A</td>
		<td id="id_c_ltp_2" class="f-c-green">#N/A</td>	 
		 <!-- <th class="f-color" rowspan="2" colspan="2" width="11%" style="background-color:#fce4d6;">Data Pulse<br>Global data feeds</th> -->
		 <!-- <td class="f-color" colspan="3">Action</td>  -->
		 <!-- <td class="f-color">Fll</td> -->
		<td id="id_strike_small_9" colspan="2">N/A</td>
		<td id="id_pcr_9" colspan="2">N/A</td>
		<td id="id_net_change_9" colspan="3">N/A</td>
	</tr>
	<tr class="text-center">
		<td id="id_strike_price_3" class="f-color" style="background-color:#d9d9d9;">#value</td> 
		<td id="id_call_chng_oi_3" class="f-c-green" colspan="2" style="background-color: #e2efda;">#N/A</td>
		<td id="id_put_chng_oi_3" class="f-c-red" colspan="2" style="background-color:#f8cbad;">#N/A</td>
		<td id="id_p_ltp_1" class="f-c-red">#N/A</td>
		
		<td style="background: #83d0c9;">FII</td>
		<td style="background: #83d0c9;">OI</td>
		<td style="background: #83d0c9;">SGX</td>
		<td style="background: #83d0c9;">PREOP</td>			
		<td colspan="2" style="background: #ff9248; color: black;">Sentiment</td>
		
		<!-- <td class="f-c-green" colspan="8" rowspan="2"> -->
			<!-- <img style="width: 100px;" src="{% static 'Website/assets/images/geniLogo.jpeg' %}"> -->
		 <!-- </td> -->
	</tr>
	<tr class="text-center">
		
		<td class="f-color" colspan="2" style="background-color:#d9d9d9;">Total</td>
		<td id="id_total_call_chng_oi" class="f-c-green" colspan="2">#N/A</td>
		<td id="id_total_put_chng_oi" class="f-c-red" colspan="2">#N/A</td>
		<td id="id_total_ltp" class="f-c-red"></td>
		
		<!-- <td class="f-c-red" colspan="2" width="11%" style="background-color:#d9e1f2;"></td> -->
		<!-- <td class="f-color" colspan="3">Action</td> -->
		<!-- <td class="f-color">Fll</td> -->
				
		<td>
			<select id="id_fil">
				<option selected></option>
				<option {% if sentiments_obj.fil == 'P' %} selected {% endif %} value="p">P</option>
				<option {% if sentiments_obj.fil == 'N' %} selected {% endif %} value="n">N</option>
			<select>
		</td>
		<td>
			<select id="id_oi">
				<option selected></option>
				<option {% if sentiments_obj.oi == 'P' %} selected {% endif %} value="p">P</option>
				<option {% if sentiments_obj.oi == 'N' %} selected {% endif %} value="n">N</option>
			<select>
		</td>
		<td>
			<select id="id_sgx">
				<option selected></option>
				<option {% if sentiments_obj.sgx == 'P' %} selected {% endif %} value="p">P</option>
				<option {% if sentiments_obj.sgx == 'N' %} selected {% endif %} value="n">N</option>
			<select>
		</td>
		<td>
			<select id="id_preop">
				<option selected></option>
				<option {% if sentiments_obj.preop == 'P' %} selected {% endif %} value="p">P</option>
				<option {% if sentiments_obj.preop == 'N' %} selected {% endif %} value="n">N</option>
			<select>
		</td>
		<td colspan="2" class="text-uppercase" id="id_sentiment_val">N/A</td>
	</tr>

	</tbody>
</table>

</div>

</div>
 
	<div id="log_div" class="row card shadow" >
		<div id="log_div_new" class="" style="padding: 15px;display: flex; flex-direction: row; width: 100%;">
			<div class="history_log ml-3">
				<div class="row">
					<div class="text-uppercase col-md-10 mt-1 text-right" style="font-family: sans-serif, 'Helvetica Neue', 'Lucida Grande', Arial; font-stretch: expanded; font-weight: 500; font-size: 14px;">
						Three Strike Range Change in OI Analysis
					</div>
					<div class="col-md-2" style="padding-right: 50px;">
						<select class="form-control" id="id_time_select">
							<option value="60000" {% if interval_obj.interval == 1 %} selected {% endif %}>1</option>
							<option value="120000" {% if interval_obj.interval == 2 %} selected {% endif %}>2</option>
							<option value="180000" {% if interval_obj.interval == 3 %} selected {% endif %}>3</option>
							<option value="240000" {% if interval_obj.interval == 4 %} selected {% endif %}>4</option>
							<option value="300000" {% if interval_obj.interval == 5 %} selected {% endif %}>5</option>
						</select>
					</div>
				</div>
				<table class="mb-0 mt-3 table table-bordered table-responsive scrolldown" id="history_log_table" style="width: 100% !important; max-height:500px !important;">
					<thead>
						<tr class="text-center">
							<th rowspan="2" style="background: lightgrey; color: black;">Time</th>
							<th colspan="3" style="background: lightgreen; color: black;">CALL Change OI</th>
							<th colspan="3" style="background: red; color: black;">PUT Change OI</th>
							<th rowspan="2" style="background: lightgreen; color: black;">TTL CALL OI Change</th>
							<th rowspan="2" style="background: red; color: black;">TTL PUT OI Change</th>
							<th rowspan="2" style="background: #FAFA33; color: black;">Spot Price</th>
							<th rowspan="2" style="background: #00ffff; color: black;">Intraday Market View</th>
							<th colspan="2" style="">Change %</th>
							<!-- <th colspan="1" style="">%</th>  -->
							<th rowspan="2" style="background: lightgreen; color: black;">Short Term View</th>
						</tr>
						<tr class="text-center">
							<th id="id_h_call_change_oi_1" style="background: #353935; color: lightgreen;">#value</th>
							<th id="id_h_call_change_oi_2" style="background: #353935; color: lightgreen;">#value</th>
							<th id="id_h_call_change_oi_3" style="background: #353935; color: lightgreen;">#value</th>
							
							<th id="id_h_put_change_oi_1" style="background: #353935; color: white;">#value</th>
							<th id="id_h_put_change_oi_2" style="background: #353935; color: white;">#value</th>
							<th id="id_h_put_change_oi_3" style="background: #353935; color: white;">#value</th>
							
							<th style="color: lightgreen;">CE</th>
							<th style="color: red;">PE</th>
							
							<!-- <th style="">Dchange</th> -->
						</tr>
					</thead>
					<tbody id="id_history_table_body">
					</tbody>
				</table>
			</div>
			<div class="total_history_log">
				<div class="row">
					<div class="text-uppercase col-md-8 mt-1 text-right" style="font-family: sans-serif, 'Helvetica Neue', 'Lucida Grande', Arial; font-stretch: expanded; font-weight: 500; font-size: 14px; max-width: 500px;">
						Total change in OI Analysis
					</div>
					<div class="col-md-4" style="padding-right: 20px;">
						<select class="form-control" id="id_time_select_total">
							<!-- <option value="180000" {% if interval_obj.interval_total_oi == 3 %} selected {% endif %}>3</option> -->
							<option {% if interval_obj.interval_total_oi == 3 %} selected {% endif %} value="180000">3</option>
							<option {% if interval_obj.interval_total_oi == 4 %} selected {% endif %} value="240000">4</option>
							<option {% if interval_obj.interval_total_oi == 5 %} selected {% endif %} value="300000">5</option>
							<option {% if interval_obj.interval_total_oi == 6 %} selected {% endif %} value="360000">6</option>
							<option {% if interval_obj.interval_total_oi == 7 %} selected {% endif %} value="420000">7</option>
							<option {% if interval_obj.interval_total_oi == 8 %} selected {% endif %} value="480000">8</option>
							<option {% if interval_obj.interval_total_oi == 9 %} selected {% endif %} value="540000">9</option>
							<option {% if interval_obj.interval_total_oi == 10 %} selected {% endif %} value="600000">10</option>
							<option {% if interval_obj.interval_total_oi == 11 %} selected {% endif %} value="660000">11</option>
							<option {% if interval_obj.interval_total_oi == 12 %} selected {% endif %} value="720000">12</option>
							<option {% if interval_obj.interval_total_oi == 13 %} selected {% endif %} value="780000">13</option>
							<option {% if interval_obj.interval_total_oi == 14 %} selected {% endif %} value="840000">14</option>
							<option {% if interval_obj.interval_total_oi == 15 %} selected {% endif %} value="900000">15</option>
						</select>
					</div>
				</div>
				<table style="width: 100% !important; max-height:500px !important;"; class="mb-0 mt-3 table table-bordered table-responsive table-responsive scrolldown" id="total_history_log_table" style="width: 100% !important; max-height:500px !important;">
					<thead>
						<tr class="text-center">
							<th rowspan="2" style="background: #FAFA33; color: black;">Time</th>
							<th style="background: lightgreen; color: black;">CALL Change OI</th>
							<th style="background: red; color: white;">PUT Change OI</th>
							<th rowspan="2" style="background: lightgreen; color: black;">Diff</th>
							<th rowspan="2" style="background: #87ceeb; color: white;">TREND</th>
							<th rowspan="2" style="background: #ffcccb; color: red;">% Change</th>
						</tr>
					</thead>
					<tbody id="id_total_history_table_body">
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
	

	
<div class="tab-pane fade " id="pills-oi_analysis_dashboard" role="tabpanel" aria-labelledby="pills-merchant-tab">
 {% verbatim  %}
<div id='app'>
	<div class="main-card card">
		<div class="card-body"> 
			<h5 class="card-title">OI Analysis Dashboard</h5>
				<table class="mb-0 table table-bordered" id="option_analysis_table" style="width: 100% !important;">
					<thead>
						<tr>
							<td colspan="7" class="text-center" style="background: lightgreen;">CE</td>
							<td></td>
							<td colspan="7" class="text-center" style="background: red; color: white;">PE</td>
						<tr>
						<tr class="text-center">
							<th style="background: #fe5a1d; color: white;">Interpretation</th>
							<th style="background: #fe5a1d; color: white;">OI</th>
							<th style="background: #fe5a1d; color: white;">Change OI CE</th>
							<th style="background: #fe5a1d; color: white;">Volume CE</th>
							<th style="background: #fe5a1d; color: white;">Price Change</th>
							<th style="background: #fe5a1d; color: white;">LTP</th>
							<th style="background: #fe5a1d; color: white;">IV</th>
							<th style="background: #fe5a1d; color: white;">Strike Price</th>
							<th style="background: #fe5a1d; color: white;">IV</th>
							<th style="background: #fe5a1d; color: white;">LTP</th>
							<th style="background: #fe5a1d; color: white;">Price Change</th>
							<th style="background: #fe5a1d; color: white;">volume PE</th>
							<th style="background: #fe5a1d; color: white;">Change OI PE</th>
							<th style="background: #fe5a1d; color: white;">OI</th>
							<th style="background: #fe5a1d; color: white;">Interpretation</th>
							<th class="f-color bg-1" style="background: #FFFF8F;">SPOT</th>
							<th class="f-color bg-1" style="background: #FFFF8F;">PCR</th>
							<th class="f-color bg-1" style="background: #FFFF8F;">Netchange</th>
						</tr>
					</thead>
					<tbody id="tbodyid">
					</tbody>
				</table>
		</div>
	</div>
</div>
{% endverbatim	%}
	</div>

</div>

</row>

</div>

</div>
</div>

<!-- <script> -->
	<!-- {% if user.subscription_status == 'Inactive' or not user.subscription_status %} -->
		<!-- let timerInterval; -->
		<!-- Swal.fire({ -->
		  <!-- title: 'Warning!', -->
		  <!-- html: 'You Do Not Have Any Active Subscription', -->
		  <!-- timer: 5000, -->
		  <!-- buttons: false, -->
		  <!-- timerProgressBar: true, -->
		  <!-- didOpen: () => { -->
			<!-- Swal.showLoading() -->
			<!-- const b = Swal.getHtmlContainer().querySelector('b') -->
			<!-- timerInterval = setInterval(() => { -->
			  <!-- b.textContent = Swal.getTimerLeft() -->
			<!-- }, 100) -->
		  <!-- }, -->
		  <!-- allowOutsideClick: false, -->
		  <!-- willClose: () => { -->
			<!-- clearInterval(timerInterval) -->
		  <!-- }, -->
		<!-- }).then((result) => { -->
		  <!-- if (result.dismiss === Swal.DismissReason.timer)  -->
		  <!-- { -->
			<!-- location.href = "/#criptocurrency-price-section"; -->
		  <!-- } -->
		<!-- }) -->
	<!-- {% endif %} -->
<!-- </script> -->
<script>
var genimode_first_count = 0;

function sentiment_detector()
{
	sentiment_fil = $("#id_fil option:selected").text();
	sentiment_oi = $("#id_oi option:selected").text();
	sentiment_sgx = $("#id_sgx option:selected").text();
	sentiment_preop = $("#id_preop option:selected").text();
	
	var arr = [sentiment_fil, sentiment_oi, sentiment_sgx, sentiment_preop];
	
	const count = {"":0,"P":0,"N":0};

	for (const element of arr) 
	{
	  if (count[element]) 
	  {
		count[element] += 1;
	  } 
	  else 
	  {
		count[element] = 1;
	  }
	}
	
	if(count[""] > 0)
	{
		$('#id_sentiment_val').html('N/A');
		document.getElementById('id_sentiment_val').style.background = 'white';
		document.getElementById('id_sentiment_val').style.color = 'black';
	}
	else if(count["P"] > 2)
	{
		$('#id_sentiment_val').html('Positive');
		document.getElementById('id_sentiment_val').style.background = 'lightgreen';
		document.getElementById('id_sentiment_val').style.color = 'black';
	}
	else if(count["N"] > 2)
	{
		$('#id_sentiment_val').html('Negative');
		document.getElementById('id_sentiment_val').style.background = 'red';
		document.getElementById('id_sentiment_val').style.color = 'white';
	}
	else
	{
		$('#id_sentiment_val').html('Neutral');
		document.getElementById('id_sentiment_val').style.background = 'lightgrey';
		document.getElementById('id_sentiment_val').style.color = 'black';
	}
}

sentiment_detector();

$(document.body).on('change','#id_fil',function(){
	user_id = {{user.id}};
	sentiment = $("#id_fil option:selected").text();
	sentiment_type = 'fil';
	
	$.ajax({
		method: "POST",
		url: "/set_nifty_sentiments/",
		data: {
			'user_id':user_id,
			'sentiment':sentiment,
			'sentiment_type':sentiment_type,
			'type':'BankNifty'
		},
		success: function (response) 
		{	
			if(response.status == 1){}
			else{}
		}
	});
	sentiment_detector();
});

$(document.body).on('change','#id_oi',function(){
	user_id = {{user.id}};
	sentiment = $("#id_oi option:selected").text();
	sentiment_type = 'oi';
	
	$.ajax({
		method: "POST",
		url: "/set_nifty_sentiments/",
		data: {
			'user_id':user_id,
			'sentiment':sentiment,
			'sentiment_type':sentiment_type,
			'type':'BankNifty'
		},
		success: function (response) 
		{	
			if(response.status == 1){}
			else{}
		}
	});
	sentiment_detector();
});

$(document.body).on('change','#id_sgx',function(){
	user_id = {{user.id}};
	sentiment = $("#id_sgx option:selected").text();
	sentiment_type = 'sgx';
	
	$.ajax({
		method: "POST",
		url: "/set_nifty_sentiments/",
		data: {
			'user_id':user_id,
			'sentiment':sentiment,
			'sentiment_type':sentiment_type,
			'type':'BankNifty'
		},
		success: function (response) 
		{	
			if(response.status == 1){}
			else{}
		}
	});
	sentiment_detector();
});

$(document.body).on('change','#id_preop',function(){
	user_id = {{user.id}};
	sentiment = $("#id_preop option:selected").text();
	sentiment_type = 'preop';
	
	$.ajax({
		method: "POST",
		url: "/set_nifty_sentiments/",
		data: {
			'user_id':user_id,
			'sentiment':sentiment,
			'sentiment_type':sentiment_type,
			'type':'BankNifty'
		},
		success: function (response) 
		{	
			if(response.status == 1){}
			else{}
		}
	});
	sentiment_detector();
});


</script>

<script>
	var previous_call_oi = null;
	var previous_put_oi = null;
	var previous_global_difference = null;
	var add_time_arg = parseInt($("#id_time_select option:selected").text());
	var total_add_time_arg = parseInt($("#id_time_select_total option:selected").text());
	<!-- var temp_date_time = new Date (new Date().toDateString() + ' ' + '9:30'); -->
	var temp_date_time = null;
	var total_temp_date_time = null;
	var total_log_time = null;
	
	<!-- temp_date_time.setMinutes( temp_date_time.getMinutes() + add_time_arg ); -->
	<!-- alert(temp_date_time.getHours() + ":" +temp_date_time.getMinutes()); -->
	var strike_price1 = null;
	var strike_price2 = null;
	var strike_price3 = null;
	
	var global_last_spot_price = null;
	<!-- var log_time = temp_date_time.getHours() + ":" +temp_date_time.getMinutes(); -->
	
	<!-- first record at 9:30 -->
	var first_history = 'Yes';
	
		
	
<!-- History log table after market close -->

	var now_after_close = new Date();
	var dateTime_after_close = new Date (new Date().toDateString() + ' ' + '15:30');
	<!-- var dateTime_after_close = new Date (new Date().toDateString() + ' ' + '14:00'); -->
	
	if (now_after_close.getTime() > dateTime_after_close.getTime()) 
	{
		$.ajax({
			method: "POST",
			url: "/bnf_get_open_val/",
			data: {},
			success: function (response) 
			{			   
				if (response.status == "1")
				{
					var enter_strike_price = Math.round(response.data).toString();
					last2 = enter_strike_price.slice(-2);
					var diff = 0;
					var new_enter_strike_price = 0.0;
					if(last2 >= 90)
					{
						diff = 100 - parseInt(last2); 
						new_enter_strike_price = parseInt(enter_strike_price) + diff;
					}
					else if(last2 < 90)
					{
						new_enter_strike_price = enter_strike_price - last2;
					}
					else
					{
						new_enter_strike_price = enter_strike_price;
					}
					
					var arr_low = new Array();
					var arr_high = new Array();
					var array_high_val = 0;
					var array_low_val = 0;
					
					var count_temp = 100;
					arr_low.push(parseInt(new_enter_strike_price));
					for(var i = 0; i<5; i++)
					{
						arr_low.push(parseInt(new_enter_strike_price) - count_temp);
						arr_high.push(parseInt(new_enter_strike_price) + count_temp);
						
						count_temp = count_temp + 100;
					}
					arr_low.reverse();
					var new_array = arr_low.concat(arr_high);
					
					$.each(new_array , function (key, value) 
					{
						$('#id_enter_strike_price_select').append($('<option>',
						{
							value: value,
							text: value 
						}));
					});

					$("#id_enter_strike_price_select option[value='" + new_enter_strike_price + "']").attr("selected","selected");
					$('#id_strike_price_1').html(new_enter_strike_price);
					$('#id_strike_price_2').html(parseInt(new_enter_strike_price) + 100);
					$('#id_strike_price_3').html(parseInt(new_enter_strike_price) + 200);
					
					$('#id_h_call_change_oi_1').html(new_enter_strike_price);
					$('#id_h_call_change_oi_2').html(parseInt(new_enter_strike_price) + 100);
					$('#id_h_call_change_oi_3').html(parseInt(new_enter_strike_price + 200));
					
					$('#id_h_put_change_oi_1').html(new_enter_strike_price);
					$('#id_h_put_change_oi_2').html(parseInt(new_enter_strike_price) + 100);
					$('#id_h_put_change_oi_3').html(parseInt(new_enter_strike_price) + 200);
					
					strike_price1 = $('#id_h_call_change_oi_1').html();
					strike_price2 = $('#id_h_call_change_oi_2').html();
					strike_price3 = $('#id_h_call_change_oi_3').html();
					
					$.ajax({
						method: "POST",
						url: "/bnf_history_logging_data/",
						data: {
							'strike_price1': strike_price1,
							'strike_price2': strike_price2,
							'strike_price3': strike_price3,
							'first_history': first_history,
						},
						success: function (response) 
						{			   
							if (response.status == '1')
							{
								first_history = 'No';
								
								var tbodyRef = document.getElementById('history_log_table').getElementsByTagName('tbody')[0];
								add_time_arg = parseInt($("#id_time_select option:selected").text());
								var history_count = 0;
								var total_call_change = 0;
								var total_put_change = 0;
								var total_oi_change = 0;
								var first_record = 0;
								var prev_call_change_val = 0;
								var prev_put_change_val = 0;
								var string_time = null;
								var last_spot_price = null;
								
								response.data.forEach(function(value) 
								{	
									if (history_count == add_time_arg)
									{
										history_count = 0;
									}
									if (history_count==0)
									{
										newRow = tbodyRef.insertRow();
										
										cell_obj = newRow.insertCell();
										cell_obj.style.backgroundColor="#FADA5E";
										cell_obj.appendChild(document.createTextNode(value.col1.slice(0, -7)));
										
										string_time = value.col1.slice(0, -7);
										
										cell_obj = newRow.insertCell(1);
										cell_obj.style.backgroundColor="#e8e8d6";
										cell_obj.appendChild(document.createTextNode(indianRupee(value.col2)));
										
										cell_obj = newRow.insertCell(2);
										cell_obj.style.backgroundColor="#e8e8d6";
										cell_obj.appendChild(document.createTextNode(indianRupee(value.col3)));
										
										cell_obj = newRow.insertCell(3);
										cell_obj.style.backgroundColor="#e8e8d6";
										cell_obj.appendChild(document.createTextNode(indianRupee(value.col4)));
										
										
										cell_obj = newRow.insertCell(4);
										cell_obj.style.backgroundColor="#ffcccb";
										cell_obj.style.color="red";
										cell_obj.appendChild(document.createTextNode(indianRupee(value.col5)));
										
										cell_obj = newRow.insertCell(5);
										cell_obj.style.backgroundColor="#ffcccb";
										cell_obj.style.color="red";
										cell_obj.appendChild(document.createTextNode(indianRupee(value.col6)));
										
										cell_obj = newRow.insertCell(6);
										cell_obj.style.backgroundColor="#ffcccb";
										cell_obj.style.color="red";
										cell_obj.appendChild(document.createTextNode(indianRupee(value.col7)));
										
										cell_obj1 = newRow.insertCell(7);
										cell_obj1.style.backgroundColor="#353935";
										cell_obj1.style.textAlign = "center";
										total_call_change = parseInt(value.col2) + parseInt(value.col3) + parseInt(value.col4)
										cell_obj1.appendChild(document.createTextNode(indianRupee(total_call_change)));
										
										cell_obj2 = newRow.insertCell(8);
										cell_obj2.style.backgroundColor="#353935";
										cell_obj2.style.textAlign = "center";
										total_put_change = parseInt(value.col5) + parseInt(value.col6) + parseInt(value.col7)
										cell_obj2.appendChild(document.createTextNode(indianRupee(total_put_change)));
										
										if (total_call_change > total_put_change)
										{
											cell_obj1.style.color="lightgreen";
											cell_obj2.style.color="#FF7276";
										}
										else
										{
											cell_obj2.style.color="lightgreen";
											cell_obj1.style.color="#FF7276";
										}
										
										if (first_record > 0)
										{
											cell_obj = newRow.insertCell(9);
											cell_obj.style.textAlign = "center";
											<!-- cell_obj.style.background = "r"; -->
											if (parseFloat(value.col8) > last_spot_price)
											{
												cell_obj.style.background = "lightgreen";
											}
											else
											{
												cell_obj.style.background = "#ffcccb";
												cell_obj.style.color = "red";
											}
											cell_obj.appendChild(document.createTextNode(value.col8));
											
											last_spot_price = parseFloat(value.col8);
										}
										else
										{
											<!-- First Record -->
											cell_obj = newRow.insertCell(9);
											cell_obj.style.textAlign = "center";
											cell_obj.style.background = "lightgreen";
											cell_obj.appendChild(document.createTextNode(value.col8));
											last_spot_price = parseFloat(value.col8);
										}

										<!-- cell_obj = newRow.insertCell(9); -->
										<!-- cell_obj.style.textAlign = "center"; -->
										<!-- cell_obj.appendChild(document.createTextNode(value.col8)); -->
										
										total_oi_change = total_put_change - total_call_change;
										
										if (total_oi_change == 0)
										{
											cell_obj = newRow.insertCell(10);
											cell_obj.style.backgroundColor="lightpink";
											cell_obj.style.color="black";
											cell_obj.style.textAlign = "center";
											cell_obj.appendChild(document.createTextNode('No Data'));
										}
										else if(total_oi_change > 400000)
										{
											cell_obj = newRow.insertCell(10);
											cell_obj.style.backgroundColor="lightgreen";
											cell_obj.style.color="black";
											cell_obj.style.textAlign = "center";
											cell_obj.appendChild(document.createTextNode('BULLISH'));
										}
										else if(total_oi_change < 400000)
										{
											cell_obj = newRow.insertCell(10);
											cell_obj.style.backgroundColor="#fd0e35";
											cell_obj.style.color="black";
											cell_obj.style.textAlign = "center";
											cell_obj.appendChild(document.createTextNode('BEARISH'));
										}
										else if(total_oi_change < 100000)
										{
											cell_obj = newRow.insertCell(10);
											cell_obj.style.backgroundColor="lightgrey";
											cell_obj.style.color="black";
											cell_obj.style.textAlign = "center";
											cell_obj.appendChild(document.createTextNode('Wait'));
										}
										
										var ce_per = 0;
										if (first_record > 0)
										{
											if((total_call_change > 0) && (prev_call_change_val > 0))
											{
												ce_per = ((total_call_change-prev_call_change_val)/prev_call_change_val)*100;
											}
											else if((total_call_change < 0) && (prev_call_change_val < 0))
											{
												ce_per = ((total_call_change-prev_call_change_val)/-prev_call_change_val)*100;
											}
											else if((total_call_change > 0) && (prev_call_change_val < 0))
											{
												ce_per = ((total_call_change-prev_call_change_val)/-prev_call_change_val)*100;
											}
											else
											{
												ce_per = ((total_call_change-prev_call_change_val)/prev_call_change_val)*100;
											}
											if (ce_per <= 0)
											{
												cell_obj = newRow.insertCell(11);
												cell_obj.style.backgroundColor="#ffcccb";
												cell_obj.style.color="red";
												cell_obj.style.textAlign = "center";
												cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
											}
											else
											{
												cell_obj = newRow.insertCell(11);
												cell_obj.style.backgroundColor="lightgreen";
												cell_obj.style.color="black";
												cell_obj.style.textAlign = "center";
												cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
											}
										}
										else
										{
											cell_obj = newRow.insertCell(11);
											cell_obj.style.color="black";
											cell_obj.style.textAlign = "center";
											cell_obj.appendChild(document.createTextNode('-'));
										}
										
										var pe_per = 0;
										if (first_record > 0)
										{
											if((total_put_change > 0) && (prev_put_change_val > 0))
											{
												pe_per = ((total_put_change-prev_put_change_val)/prev_put_change_val)*100;
											}
											else if((total_put_change < 0) && (prev_put_change_val < 0))
											{
												pe_per = ((total_put_change-prev_put_change_val)/-prev_put_change_val)*100;
											}
											else if((total_put_change > 0) && (prev_put_change_val < 0))
											{
												pe_per = ((total_put_change-prev_put_change_val)/-prev_put_change_val)*100;
											}
											else
											{
												pe_per = ((total_put_change-prev_put_change_val)/prev_put_change_val)*100;
											}
											if (pe_per <= 0)
											{
												cell_obj = newRow.insertCell(12);
												cell_obj.style.backgroundColor="#ffcccb";
												cell_obj.style.color="red";
												cell_obj.style.textAlign = "center";
												cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
											}
											else
											{
												cell_obj = newRow.insertCell(12);
												cell_obj.style.backgroundColor="lightgreen";
												cell_obj.style.color="black";
												cell_obj.style.textAlign = "center";
												cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
											}
										}
										else
										{
											cell_obj = newRow.insertCell(11);
											cell_obj.style.color="black";
											cell_obj.style.textAlign = "center";
											cell_obj.appendChild(document.createTextNode('-'));
										}
										
										<!-- var dc_change = ((total_put_change - total_call_change)/total_call_change)*100; -->
										
										<!-- if (dc_change <= 0) -->
										<!-- { -->
											<!-- cell_obj = newRow.insertCell(13); -->
											<!-- cell_obj.style.backgroundColor="#ffcccb"; -->
											<!-- cell_obj.style.color="red"; -->
											<!-- cell_obj.style.textAlign = "center"; -->
											<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
										<!-- } -->
										<!-- else -->
										<!-- { -->
											<!-- cell_obj = newRow.insertCell(13); -->
											<!-- cell_obj.style.backgroundColor="lightgreen"; -->
											<!-- cell_obj.style.color="black"; -->
											<!-- cell_obj.style.textAlign = "center"; -->
											<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
										<!-- } -->
										
										if (pe_per>=0 && ce_per <=0)
										{
											cell_obj = newRow.insertCell(13);
											cell_obj.style.backgroundColor="lightgreen";
											cell_obj.style.color="black";
											cell_obj.style.textAlign = "center";
											cell_obj.appendChild(document.createTextNode('BULLISH'));
										}
										else if(pe_per <=0 && ce_per >= 0)
										{
											cell_obj = newRow.insertCell(13);
											cell_obj.style.backgroundColor="#fd0e35";
											cell_obj.style.color="black";
											cell_obj.style.textAlign = "center";
											cell_obj.appendChild(document.createTextNode('BEARISH'));
										}
										else
										{
											cell_obj = newRow.insertCell(13);
											cell_obj.style.backgroundColor="#eedc82";
											cell_obj.style.color="black";
											cell_obj.style.textAlign = "center";
											cell_obj.appendChild(document.createTextNode('Wait'));
										}
										first_record = 1;
										$("#history_log_table tbody").prepend(newRow);
										history_count = history_count + 1;
										prev_call_change_val = total_call_change;
										prev_put_change_val = total_put_change;
										previous_call_oi = total_call_change;
										previous_put_oi = total_put_change;
									}
									else
									{
										history_count = history_count + 1;
									}
								});
							}
							else
							{
								<!-- console.log(response.msg); -->
							}
						}
					})
				}
				else
				{
					<!-- alert(response.msg); -->
				}
			}
		});
	}

<!-- end History log table after market close -->

var t_change_trend = null;
var i_market_view = null;
	
<!-- 2nd log table of total oi change (Page Refresh Data) -->	

var total_first_history = 'Yes';

$( document ).ready(function() 
{
	$.ajax({
		method: "POST",
		url: "/bnf_total_change_oi_history_log/",
		data: {
			'first_history': total_first_history,
		},
		success: function (response) 
		{			   
			if (response.status == '1')
			{
				total_first_history = 'No';
				
				var total_tbodyRef = document.getElementById('total_history_log_table').getElementsByTagName('tbody')[0];
				var total_add_time_arg = parseInt($("#id_time_select_total option:selected").text());
				var totalhistory_count = 0;
				var total_first_record = 0;
				var previous_difference = 0;
				$('#id_total_history_table_body').empty();
				var string_time = null;
				var last_total_call = 0;
				var last_total_put = 0;
				response.data.forEach(function(value) 
				{	
					if (totalhistory_count == total_add_time_arg)
					{
						totalhistory_count = 0;
					}
					if (totalhistory_count==0)
					{
						last_total_call = value.total_call_change_oi
						last_total_put = value.total_put_change_oi
						
						newRow = total_tbodyRef.insertRow();
						
						cell_obj = newRow.insertCell();
						cell_obj.style.backgroundColor="#FADA5E";
						cell_obj.appendChild(document.createTextNode(value.today_time.slice(0, -7)));
						
						string_time = value.today_time.slice(0, -7);
						
						cell_obj = newRow.insertCell(1);
						cell_obj.style.textAlign = "center";
						cell_obj.appendChild(document.createTextNode(indianRupee(value.total_call_change_oi)));
						
						cell_obj = newRow.insertCell(2);
						cell_obj.style.textAlign = "center";
						cell_obj.appendChild(document.createTextNode(indianRupee(value.total_put_change_oi)));
						
						cell_obj = newRow.insertCell(3);
						cell_obj.style.textAlign = "center";
						cell_obj.appendChild(document.createTextNode(indianRupee(value.total_put_change_oi-value.total_call_change_oi)));
						
						var difference = parseInt(value.total_put_change_oi-value.total_call_change_oi);
						
						if (difference == 0)
						{
							cell_obj = newRow.insertCell(4);
							cell_obj.style.backgroundColor="lightpink";
							cell_obj.style.color="black";
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode('No Data'));
							t_change_trend = 'No Data';
						}
						else if (difference >= 1000000)
						{
							cell_obj = newRow.insertCell(4);
							cell_obj.style.backgroundColor="lightgreen";
							cell_obj.style.color="black";
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode('BULLISH'));
							t_change_trend = 'BULLISH';
						}
						else if(difference <= -500000)
						{
							cell_obj = newRow.insertCell(4);
							cell_obj.style.backgroundColor="#fd0e35";
							cell_obj.style.color="black";
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode('BEARISH'));
							t_change_trend = 'BEARISH';
						}
						else if (difference >= 500001)
						{
							cell_obj = newRow.insertCell(4);
							cell_obj.style.backgroundColor="lightgrey";
							cell_obj.style.color="black";
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode('Wait'));
							t_change_trend = 'Wait';
						}
						else if(difference >= -499999)
						{
							cell_obj = newRow.insertCell(4);
							cell_obj.style.backgroundColor="lightgrey";
							cell_obj.style.color="black";
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode('Wait'));
							t_change_trend = 'Wait';
						}
						<!-- =IFERROR(IF(AND((U2>0),(U3>0)),(U2-U3)/U3, IF(AND((U2<0),(U3<0)),(U2-U3)/-U3, -->
						<!-- IF(AND((U2>0),(U3<0)),(U2-U3)/-U3,(U2-U3)/U3))),"")  -->
						if (total_first_record == 0)
						{
							cell_obj = newRow.insertCell(5);
							cell_obj.style.backgroundColor="lightgrey";
							cell_obj.style.color="black";
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode('-'));
							total_first_record = 1;	
						}
						else
						{		
							var change_per = 0;
							if(difference > 0 && previous_difference > 0)
							{
								change_per = (difference - previous_difference)/previous_difference;
							}
							else if(difference < 0 && previous_difference < 0)
							{
								change_per = (difference - previous_difference)/-previous_difference;
							}
							else if(difference > 0 && previous_difference < 0)
							{
								change_per = (difference - previous_difference)/-previous_difference;
							}
							else
							{
								change_per = (difference - previous_difference)/previous_difference;
							}
							cell_obj = newRow.insertCell(5);
							cell_obj.style.backgroundColor="lightgrey";
							cell_obj.style.color="black";
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode(change_per.toFixed(2) + "%"));
						}
						
						previous_difference = difference;
						previous_global_difference = difference;
						$("#total_history_log_table tbody").prepend(newRow);
						totalhistory_count = 1;							
					}
					else
					{
						totalhistory_count = totalhistory_count + 1;
					}
				});
				
				if (parseFloat(last_total_call) < parseFloat(last_total_put))
				{
					$('#id_bull_bear').html('BULLISH');
					document.getElementById('id_bull_bear').style.backgroundColor = "lightgreen"; 
					document.getElementById('id_bull_bear').style.color = "black"; 
				}
				else
				{
					$('#id_bull_bear').html('BEARISH');
					document.getElementById('id_bull_bear').style.backgroundColor = "red"; 
					document.getElementById('id_bull_bear').style.color = "white"; 
				}
				total_history_data_time = parseInt($("#id_time_select_total option:selected").val());
				
				total_add_time_arg = parseInt($("#id_time_select_total option:selected").text());
				
				<!-- clearInterval(run1); -->
				
				total_temp_date_time = new Date (new Date().toDateString() + ' ' + string_time);
				total_temp_date_time.setMinutes( total_temp_date_time.getMinutes() + total_add_time_arg );
				
				run1 = setInterval(request1 , total_history_data_time)
			}
			else
			{
				<!-- console.log(response.msg); -->
			}
		}
		
	});	
});

var bul_count = 0;
var bear_count = 0;
var bullish_status = false;
var bearish_status = false;
var other_status = false;
function geniModeCalculation(a)
{
	if (i_market_view == 'BEARISH' && t_change_trend == 'BEARISH')
	{
		if (bear_count == 0)
		{
			var strike_price = $('#id_strike_price_3').html();
			var cur_ltp = $('#id_p_ltp_1').html();
			var selected_strike_price = parseInt($("#id_enter_strike_price_select option:selected").text());

			$.ajax({
				method: "POST",
				url: "/get_active_genimode/",
				data: {
					'geni_type':'BEARISH',
					'strike_price': strike_price,
					'cur_ltp': cur_ltp,
					'symbol':'BankNifty',
					'status':'On',
					'selected_strike_price':selected_strike_price,
				},
				success: function (response) 
				{		
					<!-- alert(response.msg[0]['genimode_stop_loss_on'] == true); -->
					if (response.status == '1')
					{
						bear_count = 1;
						bul_count = 0;
						bearish_status = true;
						bullish_status = false;
						other_status = false;
						$('#id_buy_strike_price').html(response.msg[0]['genimode_strike_price']);
						$('#id_ce_pe').html('PE');
						document.getElementById('id_buy_strike_price').style.color = 'red';
						$('#id_buy_ltp_1').html(response.msg[0]['genimode_current_ltp']);
						$('#id_buy_ltp_2').html(response.msg[0]['genimode_target']);
						document.getElementById('id_buy_ltp_2').style.color = 'red';
						$('#id_geni_mode').html('ON');
						document.getElementById('id_geni_mode').style.color = 'green';
						$('#id_geni_mode_logo').show();
						$('#id_geni_mode_logo_off').hide();
						
						if (response.msg[0]['genimode_target_on'] == true)
						{
							$('#id_led_box').show();
							$('#id_led_box_2').hide();
						}
						else if (response.msg[0]['genimode_stop_loss_on'] == true)
						{
							$('#id_led_box').hide();
							$('#id_led_box_2').show();
						}
						else
						{
							$('#id_led_box').hide();
							$('#id_led_box_2').hide();
						}
					}
					else
					{}
				}
			});
		}
	}
	else if (i_market_view == 'BULLISH' && t_change_trend == 'BULLISH')
	{
		if (bul_count == 0)
		{
			<!-- alert('bullish'); -->
			var strike_price = $('#id_strike_price_1').html();
			var cur_ltp = $('#id_c_ltp_1').html();
			var selected_strike_price = parseInt($("#id_enter_strike_price_select option:selected").text());

			$.ajax({
				method: "POST",
				url: "/get_active_genimode/",
				data: {
					'geni_type':'BULLISH',
					'strike_price': strike_price,
					'cur_ltp': cur_ltp,
					'symbol':'BankNifty',
					'status':'On',
					'selected_strike_price':selected_strike_price,
				},
				success: function (response) 
				{			   
					if (response.status == '1')
					{
						bear_count = 0;
						bul_count = 1;
						console.log(response.msg);
						bullish_status = true;
						bearish_status = false;
						other_status = false;
						$('#id_buy_strike_price').html(response.msg[0]['genimode_strike_price']);
						$('#id_ce_pe').html('CE');
						document.getElementById('id_buy_strike_price').style.color = 'green';
						$('#id_buy_ltp_1').html(response.msg[0]['genimode_current_ltp']);
						$('#id_buy_ltp_2').html(response.msg[0]['genimode_target']);
						document.getElementById('id_buy_ltp_2').style.color = 'green';
						$('#id_geni_mode').html('ON');
						document.getElementById('id_geni_mode').style.color = 'green';
						$('#id_geni_mode_logo').show();
						$('#id_geni_mode_logo_off').hide();
						
						if (response.msg[0]['genimode_target_on'] == true)
						{
							$('#id_led_box').show();
							$('#id_led_box_2').hide();
						}
						else if (response.msg[0]['genimode_stop_loss_on'] == true)
						{
							$('#id_led_box').hide();
							$('#id_led_box_2').show();
						}
						else
						{
							$('#id_led_box').hide();
							$('#id_led_box_2').hide();
						}
					}
					else
					{}
				}
			});
		}
	} 
	else
	{
		bullish_status = false;
		bearish_status = false;
		other_status = true;
		bul_count = 0;
		bear_count = 0;
		
		var strike_price = $('#id_strike_price_1').html();
		var cur_ltp = $('#id_c_ltp_1').html();
		var selected_strike_price = parseInt($("#id_enter_strike_price_select option:selected").text());

		$.ajax({
			method: "POST",
			url: "/get_active_genimode/",
			data: {
				'geni_type':'WAIT',
				'strike_price': strike_price,
				'cur_ltp': cur_ltp,
				'symbol':'BankNifty',
				'status':'Off',
				'selected_strike_price':selected_strike_price,
			},
			success: function (response) 
			{			   
				if (response.status == '1')
				{
					$('#id_buy_strike_price').html('WAIT');
					$('#id_ce_pe').html('-');
					document.getElementById('id_buy_strike_price').style.color = 'black';
					$('#id_buy_ltp_1').html('N/A');
					$('#id_buy_ltp_2').html('N/A');
					$('#id_geni_mode').html('OFF');
					document.getElementById('id_geni_mode').style.color = 'red';
					$('#id_geni_mode_logo').hide();
					$('#id_geni_mode_logo_off').show();
					$('#id_led_box').hide();
					$('#id_led_box_2').hide();
				}
				else
				{}
			}
		});
	}
}

<!-- End 2nd log table of total oi change (Page Refresh Data) -->	
	
<!-- 2nd log table of total oi change (select change event) -->
	
	$(document.body).on('change','#id_time_select_total',function(){
		user_id = {{user.id}};
		interval_val = parseInt($("#id_time_select_total option:selected").text());
			
		
		$.ajax({
			method: "POST",
			url: "/set_user_bank_nifty_total_interval/",
			data: {
				'user_id':user_id,
				'interval_val':interval_val, 
			},
			success: function (response) 
			{			   
				if (response.status == '1'){}
				else{}
			}
		});
		
		total_first_history = 'Yes';
		
		$.ajax({
			method: "POST",
			url: "/bnf_total_change_oi_history_log/",
			data: {
				'first_history': total_first_history,
			},
			success: function (response) 
			{			   
				if (response.status == '1')
				{
					total_first_history = 'No';
					
					var total_tbodyRef = document.getElementById('total_history_log_table').getElementsByTagName('tbody')[0];
					var total_add_time_arg = parseInt($("#id_time_select_total option:selected").text());
					var totalhistory_count = 0;
					var total_first_record = 0;
					var previous_difference = 0;
					var last_total_call = 0;
					var last_total_put = 0;
					var string_time = null;
					$('#id_total_history_table_body').empty();
					response.data.forEach(function(value) 
					{	
						if (totalhistory_count == total_add_time_arg)
						{
							totalhistory_count = 0;
						}
						if (totalhistory_count==0)
						{
							last_total_call = value.total_call_change_oi
							last_total_put = value.total_put_change_oi
							
							newRow = total_tbodyRef.insertRow();
							
							cell_obj = newRow.insertCell();
							cell_obj.style.backgroundColor="#FADA5E";
							cell_obj.appendChild(document.createTextNode(value.today_time.slice(0, -7)));
							
							string_time = value.today_time.slice(0, -7);
							
							cell_obj = newRow.insertCell(1);
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.total_call_change_oi)));
							
							cell_obj = newRow.insertCell(2);
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.total_put_change_oi)));
							
							cell_obj = newRow.insertCell(3);
							cell_obj.style.textAlign = "center";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.total_put_change_oi-value.total_call_change_oi)));
							
							var difference = parseInt(value.total_put_change_oi-value.total_call_change_oi);
							
							if (difference == 0)
							{
								cell_obj = newRow.insertCell(4);
								cell_obj.style.backgroundColor="lightpink";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('No Data'));
								t_change_trend = "No Data";
							}
							else if (difference >= 1000000)
							{
								cell_obj = newRow.insertCell(4);
								cell_obj.style.backgroundColor="lightgreen";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BULLISH'));
								t_change_trend = "BULLISH";
							}
							else if(difference <= -500000)
							{
								cell_obj = newRow.insertCell(4);
								cell_obj.style.backgroundColor="#fd0e35";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BEARISH'));
								t_change_trend = "BEARISH";
							}
							else if (difference >= 500001)
							{
								cell_obj = newRow.insertCell(4);
								cell_obj.style.backgroundColor="lightgrey";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('Wait'));
								t_change_trend = "Wait";
							}
							else if(difference >= -499999)
							{
								cell_obj = newRow.insertCell(4);
								cell_obj.style.backgroundColor="lightgrey";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('Wait'));
								t_change_trend = "Wait";
							}
							<!-- =IFERROR(IF(AND((U2>0),(U3>0)),(U2-U3)/U3, IF(AND((U2<0),(U3<0)),(U2-U3)/-U3, -->
							<!-- IF(AND((U2>0),(U3<0)),(U2-U3)/-U3,(U2-U3)/U3))),"")  -->
							if (total_first_record == 0)
							{
								cell_obj = newRow.insertCell(5);
								cell_obj.style.backgroundColor="lightgrey";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('-'));
								total_first_record = 1;	
							}
							else
							{		
								var change_per = 0;
								if(difference > 0 && previous_difference > 0)
								{
									change_per = (difference - previous_difference)/previous_difference;
								}
								else if(difference < 0 && previous_difference < 0)
								{
									change_per = (difference - previous_difference)/-previous_difference;
								}
								else if(difference > 0 && previous_difference < 0)
								{
									change_per = (difference - previous_difference)/-previous_difference;
								}
								else
								{
									change_per = (difference - previous_difference)/previous_difference;
								}
								cell_obj = newRow.insertCell(5);
								cell_obj.style.backgroundColor="lightgrey";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode(change_per.toFixed(2) + "%"));
							}
							
							previous_difference = difference;
							previous_global_difference = difference;
							$("#total_history_log_table tbody").prepend(newRow);
							totalhistory_count = 1;							
						}
						else
						{
							totalhistory_count = totalhistory_count + 1;
						}
					});
					
					if (parseFloat(last_total_call) < parseFloat(last_total_put))
					{
						$('#id_bull_bear').html('BULLISH');
						document.getElementById('id_bull_bear').style.backgroundColor = "lightgreen"; 
						document.getElementById('id_bull_bear').style.color = "black"; 
					}
					else
					{
						$('#id_bull_bear').html('BEARISH');
						document.getElementById('id_bull_bear').style.backgroundColor = "red"; 
						document.getElementById('id_bull_bear').style.color = "white"; 
					}
					
					total_history_data_time = parseInt($("#id_time_select_total option:selected").val());
				
					total_add_time_arg = parseInt($("#id_time_select_total option:selected").text());
					
					clearInterval(run1);
					
					total_temp_date_time = new Date (new Date().toDateString() + ' ' + string_time);
					total_temp_date_time.setMinutes( total_temp_date_time.getMinutes() + total_add_time_arg );
					
					run1 = setInterval(request1 , total_history_data_time)
					
					geniModeCalculation(1);
				}
				else
				{
					<!-- console.log(response.msg); -->
				}
			}
		});	
	});

<!-- end 2nd log table of total oi change (select change event)	 -->

<!-- 2nd log table of total oi change (Interval Function)  -->

async function request1() 
{ 
	if(total_temp_date_time.getMinutes() < 10)
	{
		total_log_time = total_temp_date_time.getHours() + ":0" +total_temp_date_time.getMinutes();
	}
	else
	{
		total_log_time = total_temp_date_time.getHours() + ":" +total_temp_date_time.getMinutes();
	}
	
	<!-- console.log(total_log_time); -->
	
	total_first_history = 'No';
		
	$.ajax({
		method: "POST",
		url: "/bnf_total_change_oi_history_log/",
		data: {
			'first_history': total_first_history,
			'total_log_time': total_log_time,
		},
		success: function (response) 
		{			   
			if (response.status == '1')
			{
				total_first_history = 'No';
				
				var total_tbodyRef = document.getElementById('total_history_log_table').getElementsByTagName('tbody')[0];
				var total_add_time_arg = parseInt($("#id_time_select_total option:selected").text());
				var string_time = null;
				
				total_temp_date_time.setMinutes( total_temp_date_time.getMinutes() + total_add_time_arg );
				
				response.data.forEach(function(value) 
				{	
					newRow = total_tbodyRef.insertRow();
					
					cell_obj = newRow.insertCell();
					cell_obj.style.backgroundColor="#FADA5E";
					cell_obj.appendChild(document.createTextNode(value.today_time.slice(0, -7)));
					
					string_time = value.today_time.slice(0, -7);
					
					cell_obj = newRow.insertCell(1);
					cell_obj.style.textAlign = "center";
					cell_obj.appendChild(document.createTextNode(indianRupee(value.total_call_change_oi)));
					
					cell_obj = newRow.insertCell(2);
					cell_obj.style.textAlign = "center";
					cell_obj.appendChild(document.createTextNode(indianRupee(value.total_put_change_oi)));
					
					if (parseFloat(value.total_call_change_oi) < parseFloat(value.total_put_change_oi))
					{
						$('#id_bull_bear').html('BULLISH');
						document.getElementById('id_bull_bear').style.backgroundColor = "lightgreen"; 
						document.getElementById('id_bull_bear').style.color = "black"; 
					}
					else
					{
						$('#id_bull_bear').html('BEARISH');
						document.getElementById('id_bull_bear').style.backgroundColor = "red"; 
						document.getElementById('id_bull_bear').style.color = "white"; 
					}
					
					cell_obj = newRow.insertCell(3);
					cell_obj.style.textAlign = "center";
					cell_obj.appendChild(document.createTextNode(indianRupee(value.total_put_change_oi-value.total_call_change_oi)));
					
					var difference = parseInt(value.total_put_change_oi-value.total_call_change_oi);
					
					if (difference == 0)
					{
						cell_obj = newRow.insertCell(4);
						cell_obj.style.backgroundColor="lightpink";
						cell_obj.style.color="black";
						cell_obj.style.textAlign = "center";
						cell_obj.appendChild(document.createTextNode('No Data'));
						t_change_trend = "No Data";
					}
					else if (difference >= 1000000)
					{
						cell_obj = newRow.insertCell(4);
						cell_obj.style.backgroundColor="lightgreen";
						cell_obj.style.color="black";
						cell_obj.style.textAlign = "center";
						cell_obj.appendChild(document.createTextNode('BULLISH'));
						t_change_trend = "BULLISH";
					}
					else if(difference <= -500000)
					{
						cell_obj = newRow.insertCell(4);
						cell_obj.style.backgroundColor="#fd0e35";
						cell_obj.style.color="black";
						cell_obj.style.textAlign = "center";
						cell_obj.appendChild(document.createTextNode('BEARISH'));
						t_change_trend = "BEARISH";
					}
					else if (difference >= 500001)
					{
						cell_obj = newRow.insertCell(4);
						cell_obj.style.backgroundColor="lightgrey";
						cell_obj.style.color="black";
						cell_obj.style.textAlign = "center";
						cell_obj.appendChild(document.createTextNode('Wait'));
						t_change_trend = "Wait";
					}
					else if(difference >= -499999)
					{
						cell_obj = newRow.insertCell(4);
						cell_obj.style.backgroundColor="lightgrey";
						cell_obj.style.color="black";
						cell_obj.style.textAlign = "center";
						cell_obj.appendChild(document.createTextNode('Wait'));
						t_change_trend = "Wait";
					}
							
					var change_per = 0;
					if(difference > 0 && previous_global_difference > 0)
					{
						change_per = (difference - previous_global_difference)/previous_global_difference;
					}
					else if(difference < 0 && previous_global_difference < 0)
					{
						change_per = (difference - previous_global_difference)/-previous_global_difference;
					}
					else if(difference > 0 && previous_global_difference < 0)
					{
						change_per = (difference - previous_global_difference)/-previous_global_difference;
					}
					else
					{
						change_per = (difference - previous_global_difference)/previous_global_difference;
					}
					cell_obj = newRow.insertCell(5);
					cell_obj.style.backgroundColor="lightgrey";
					cell_obj.style.color="black";
					cell_obj.style.textAlign = "center";
					cell_obj.appendChild(document.createTextNode(change_per.toFixed(2) + "%"));
					
					
					previous_global_difference = difference;
					$("#total_history_log_table tbody").prepend(newRow);
				});
				geniModeCalculation(2);
			}
			else
			{
				<!-- console.log(response.msg); -->
			}
		}
	});	
	
};

<!-- end 2nd log table of total oi change (Interval Function)  -->



	
	
	var history_data_time = $("#id_time_select option:selected").val();
	
	var run = null; // start setInterval as "run"
	
	$(document.body).on('change','#id_time_select',function(){
		user_id = {{user.id}};
		interval_val = parseInt($("#id_time_select option:selected").text());
		
		$.ajax({
			method: "POST",
			url: "/set_bank_nifty_user_interval/",
			data: {
				'user_id':user_id,
				'interval_val':interval_val,
			},
			success: function (response) 
			{			   
				if (response.status == '1'){}
				else{}
			}
		});
		
		first_history = 'Yes';
		<!-- strike_price1 = '17700'; -->
		<!-- strike_price2 = '17750'; -->
		<!-- strike_price3 = '17800'; -->
		strike_price1 = $('#id_h_call_change_oi_1').html();
		strike_price2 = $('#id_h_call_change_oi_2').html();
		strike_price3 = $('#id_h_call_change_oi_3').html();
		
		$.ajax({
			method: "POST",
			url: "/bnf_history_logging_data/",
			data: {
				'strike_price1': strike_price1,
				'strike_price2': strike_price2,
				'strike_price3': strike_price3,
				'first_history': first_history,
			},
			success: function (response) 
			{			   
				if (response.status == '1')
				{
					first_history = 'No';
					
					var tbodyRef = document.getElementById('history_log_table').getElementsByTagName('tbody')[0];
					add_time_arg = parseInt($("#id_time_select option:selected").text());
					var history_count = 0;
					var total_call_change = 0;
					var total_put_change = 0;
					var total_oi_change = 0;
					var first_record = 0;
					var prev_call_change_val = 0;
					var prev_put_change_val = 0;
					var last_spot_price = 0;
					
					$('#id_history_table_body').empty();
					var string_time = null;
					response.data.forEach(function(value) 
					{	
						if (history_count == add_time_arg)
						{
							history_count = 0;
						}
						if (history_count==0)
						{
							newRow = tbodyRef.insertRow();
							
							cell_obj = newRow.insertCell();
							cell_obj.style.backgroundColor="#FADA5E";
							cell_obj.appendChild(document.createTextNode(value.col1.slice(0, -7)));
							
							string_time = value.col1.slice(0, -7);
							
							cell_obj = newRow.insertCell(1);
							cell_obj.style.backgroundColor="#e8e8d6"; 
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col2)));
							
							cell_obj = newRow.insertCell(2);
							cell_obj.style.backgroundColor="#e8e8d6";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col3)));
							
							cell_obj = newRow.insertCell(3);
							cell_obj.style.backgroundColor="#e8e8d6";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col4)));
							
							
							cell_obj = newRow.insertCell(4);
							cell_obj.style.backgroundColor="#ffcccb";
							cell_obj.style.color="red";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col5)));
							
							cell_obj = newRow.insertCell(5);
							cell_obj.style.backgroundColor="#ffcccb";
							cell_obj.style.color="red";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col6)));
							
							cell_obj = newRow.insertCell(6);
							cell_obj.style.backgroundColor="#ffcccb";
							cell_obj.style.color="red";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col7)));
							
							cell_obj1 = newRow.insertCell(7);
							cell_obj1.style.backgroundColor="#353935";
							cell_obj1.style.textAlign = "center";
							total_call_change = parseInt(value.col2) + parseInt(value.col3) + parseInt(value.col4)
							cell_obj1.appendChild(document.createTextNode(indianRupee(total_call_change)));
							
							cell_obj2 = newRow.insertCell(8);
							cell_obj2.style.backgroundColor="#353935";
							cell_obj2.style.textAlign = "center";
							total_put_change = parseInt(value.col5) + parseInt(value.col6) + parseInt(value.col7)
							cell_obj2.appendChild(document.createTextNode(indianRupee(total_put_change)));							
							
							if (total_call_change > total_put_change)
							{
								cell_obj1.style.color="#FF7276";
								cell_obj2.style.color="#FF7276";
							}
							else
							{
								cell_obj2.style.color="lightgreen";
								cell_obj1.style.color="#FF7276";
							}
							<!-- if (total_call_change > total_put_change) -->
							<!-- { -->
								<!-- cell_obj1.style.color="lightgreen"; -->
								<!-- cell_obj2.style.color="#FF7276"; -->
							<!-- } -->
							<!-- else -->
							<!-- { -->
								<!-- cell_obj2.style.color="lightgreen"; -->
								<!-- cell_obj1.style.color="#FF7276"; -->
							<!-- } -->
							
							if (first_record > 0)
							{
								cell_obj = newRow.insertCell(9);
								cell_obj.style.textAlign = "center";
								<!-- cell_obj.style.background = "r"; -->
								if (parseFloat(value.col8) > last_spot_price)
								{
									cell_obj.style.background = "lightgreen";
								}
								else
								{
									cell_obj.style.background = "#ffcccb";
									cell_obj.style.color = "red";
								}
								cell_obj.appendChild(document.createTextNode(value.col8));
								
								last_spot_price = parseFloat(value.col8);
							}
							else
							{
								<!-- First Record -->
								cell_obj = newRow.insertCell(9);
								cell_obj.style.textAlign = "center";
								cell_obj.style.background = "lightgreen";
								cell_obj.appendChild(document.createTextNode(value.col8));
								last_spot_price = parseFloat(value.col8);
							}

							<!-- cell_obj = newRow.insertCell(9); -->
							<!-- cell_obj.style.textAlign = "center"; -->
							<!-- cell_obj.appendChild(document.createTextNode(value.col8)); -->
							
							total_oi_change = total_put_change - total_call_change;
						
							if (total_oi_change == 0)
							{
								cell_obj = newRow.insertCell(10);
								cell_obj.style.backgroundColor="lightpink";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('No Data'));
								i_market_view = 'No Data';
							}
							else if(total_oi_change > 400000)
							{
								cell_obj = newRow.insertCell(10);
								cell_obj.style.backgroundColor="lightgreen";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BULLISH'));
								i_market_view = 'BULLISH';
							}
							else if(total_oi_change < 400000)
							{
								cell_obj = newRow.insertCell(10);
								cell_obj.style.backgroundColor="#fd0e35";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BEARISH'));
								i_market_view = 'BEARISH';
							}
							else if(total_oi_change < 100000)
							{
								cell_obj = newRow.insertCell(10);
								cell_obj.style.backgroundColor="lightgrey";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('Wait'));
								i_market_view = 'Wait';
							}
							
							var ce_per = 0;
							if (first_record > 0)
							{
								if((total_call_change > 0) && (prev_call_change_val > 0))
								{
									ce_per = ((total_call_change-prev_call_change_val)/prev_call_change_val)*100;
								}
								else if((total_call_change < 0) && (prev_call_change_val < 0))
								{
									ce_per = ((total_call_change-prev_call_change_val)/-prev_call_change_val)*100;
								}
								else if((total_call_change > 0) && (prev_call_change_val < 0))
								{
									ce_per = ((total_call_change-prev_call_change_val)/-prev_call_change_val)*100;
								}
								else
								{
									ce_per = ((total_call_change-prev_call_change_val)/prev_call_change_val)*100;
								}
								if (ce_per <= 0)
								{
									cell_obj = newRow.insertCell(11);
									cell_obj.style.backgroundColor="#ffcccb";
									cell_obj.style.color="red";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
								}
								else
								{
									cell_obj = newRow.insertCell(11);
									cell_obj.style.backgroundColor="lightgreen";
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
								}
							}
							else
							{
								cell_obj = newRow.insertCell(11);
								<!-- cell_obj.style.backgroundColor="lightgreen"; -->
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('-'));
							}
							
							var pe_per = 0;
							if (first_record > 0)
							{
								if((total_put_change > 0) && (prev_put_change_val > 0))
								{
									pe_per = ((total_put_change-prev_put_change_val)/prev_put_change_val)*100;
								}
								else if((total_put_change < 0) && (prev_put_change_val < 0))
								{
									pe_per = ((total_put_change-prev_put_change_val)/-prev_put_change_val)*100;
								}
								else if((total_put_change > 0) && (prev_put_change_val < 0))
								{
									pe_per = ((total_put_change-prev_put_change_val)/-prev_put_change_val)*100;
								}
								else
								{
									pe_per = ((total_put_change-prev_put_change_val)/prev_put_change_val)*100;
								}
								if (pe_per <= 0)
								{
									cell_obj = newRow.insertCell(12);
									cell_obj.style.backgroundColor="#ffcccb";
									cell_obj.style.color="red";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
								}
								else
								{
									cell_obj = newRow.insertCell(12);
									cell_obj.style.backgroundColor="lightgreen";
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
								}
							}
							else
							{
								cell_obj = newRow.insertCell(11);
								<!-- cell_obj.style.backgroundColor="lightgreen"; -->
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('-'));
							}
							
							<!-- var dc_change = ((total_put_change - total_call_change)/total_call_change)*100; -->
							
							<!-- if (dc_change <= 0) -->
							<!-- { -->
								<!-- cell_obj = newRow.insertCell(13); -->
								<!-- cell_obj.style.backgroundColor="#ffcccb"; -->
								<!-- cell_obj.style.color="red"; -->
								<!-- cell_obj.style.textAlign = "center"; -->
								<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
							<!-- } -->
							<!-- else -->
							<!-- { -->
								<!-- cell_obj = newRow.insertCell(13); -->
								<!-- cell_obj.style.backgroundColor="lightgreen"; -->
								<!-- cell_obj.style.color="black"; -->
								<!-- cell_obj.style.textAlign = "center"; -->
								<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
							<!-- } -->
							
							if (pe_per>=0 && ce_per <=0)
							{
								cell_obj = newRow.insertCell(13);
								cell_obj.style.backgroundColor="lightgreen";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BULLISH'));
							}
							else if(pe_per <=0 && ce_per >= 0)
							{
								cell_obj = newRow.insertCell(13);
								cell_obj.style.backgroundColor="#fd0e35";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BEARISH'));
							}
							else
							{
								cell_obj = newRow.insertCell(13);
								cell_obj.style.backgroundColor="#eedc82";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('Wait'));
							}
							first_record = 1;
							
							
							$("#history_log_table tbody").prepend(newRow);
							history_count = history_count + 1;
							prev_call_change_val = total_call_change;
							prev_put_change_val = total_put_change;
							previous_call_oi = total_call_change;
							previous_put_oi = total_put_change;
						}
						else
						{
							history_count = history_count + 1;
						}
					});
					<!-- console.log(response.data); -->
					history_data_time = parseInt($("#id_time_select option:selected").val());
					<!-- alert(history_data_time); -->
					
					add_time_arg = parseInt($("#id_time_select option:selected").text());
					
					clearInterval(run);
					
					temp_date_time = new Date (new Date().toDateString() + ' ' + string_time);
					temp_date_time.setMinutes( temp_date_time.getMinutes() + add_time_arg );
					
					run = setInterval(request , history_data_time);
					
					geniModeCalculation(3);
					
					global_last_spot_price = last_spot_price;
				}
				else
				{
					<!-- console.log(response.msg); -->
				}
			}
		});	
	});

	async function request() 
	{ 
		strike_price1 = $('#id_h_call_change_oi_1').html();
		strike_price2 = $('#id_h_call_change_oi_2').html();
		strike_price3 = $('#id_h_call_change_oi_3').html();
		
		if(temp_date_time.getMinutes() < 10)
		{
			log_time = temp_date_time.getHours() + ":0" +temp_date_time.getMinutes();
		}
		else
		{
			log_time = temp_date_time.getHours() + ":" +temp_date_time.getMinutes();
		}
		
		<!-- console.log(log_time); -->
		
		$.ajax({
			method: "POST",
			url: "/bnf_history_logging_data/",
			data: {
				'strike_price1':strike_price1,
				'strike_price2':strike_price2,
				'strike_price3':strike_price3,
				'log_time':log_time,
				'first_history':first_history,
			},
			success: function (response) 
			{			   
				if (response.status == '1')
				{
					var total_call_change = 0;
					var total_put_change = 0;
					var total_oi_change = 0;
					var first_record = 0;
					var prev_call_change_val = 0;
					var prev_put_change_val = 0;
					
					temp_date_time.setMinutes( temp_date_time.getMinutes() + add_time_arg );
					
					var tbodyRef = document.getElementById('history_log_table').getElementsByTagName('tbody')[0];
					newRow = tbodyRef.insertRow();
					
					var loop_count = 0;
					response.data.forEach(function(value) 
					{
						if (loop_count == 0)
						{
							cell_obj = newRow.insertCell();
							cell_obj.style.backgroundColor="#FADA5E";
							cell_obj.appendChild(document.createTextNode(value.col1.slice(0, -7)));
							
							cell_obj = newRow.insertCell(1);
							cell_obj.style.backgroundColor="#e8e8d6";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col2)));
							
							cell_obj = newRow.insertCell(2);
							cell_obj.style.backgroundColor="#e8e8d6";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col3)));
							
							cell_obj = newRow.insertCell(3);
							cell_obj.style.backgroundColor="#e8e8d6";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col4)));
							
							
							cell_obj = newRow.insertCell(4);
							cell_obj.style.backgroundColor="#ffcccb";
							cell_obj.style.color="red";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col5)));
							
							cell_obj = newRow.insertCell(5);
							cell_obj.style.backgroundColor="#ffcccb";
							cell_obj.style.color="red";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col6)));
							
							cell_obj = newRow.insertCell(6);
							cell_obj.style.backgroundColor="#ffcccb";
							cell_obj.style.color="red";
							cell_obj.appendChild(document.createTextNode(indianRupee(value.col7)));
							
							cell_obj1 = newRow.insertCell(7);
							cell_obj1.style.backgroundColor="#353935";
							cell_obj1.style.textAlign = "center";
							total_call_change = parseInt(value.col2) + parseInt(value.col3) + parseInt(value.col4)
							cell_obj1.appendChild(document.createTextNode(indianRupee(total_call_change)));
							
							cell_obj2 = newRow.insertCell(8);
							cell_obj2.style.backgroundColor="#353935";
							cell_obj2.style.textAlign = "center";
							total_put_change = parseInt(value.col5) + parseInt(value.col6) + parseInt(value.col7)
							cell_obj2.appendChild(document.createTextNode(indianRupee(total_put_change)));
							
							if (total_call_change > total_put_change)
							{
								cell_obj1.style.color="#FF7276";
								cell_obj2.style.color="#FF7276";
							}
							else
							{
								cell_obj2.style.color="lightgreen";
								cell_obj1.style.color="#FF7276";
							}
							
							
							cell_obj = newRow.insertCell(9);
							cell_obj.style.textAlign = "center";
							if (parseFloat(value.col8) > global_last_spot_price)
							{
								cell_obj.style.background = "lightgreen";
							}
							else
							{
								cell_obj.style.background = "#ffcccb";
								cell_obj.style.color = "red";
							}
							cell_obj.appendChild(document.createTextNode(value.col8));
							
							global_last_spot_price = parseFloat(value.col8);
							

							<!-- cell_obj = newRow.insertCell(9); -->
							<!-- cell_obj.style.textAlign = "center"; -->
							<!-- cell_obj.appendChild(document.createTextNode(value.col8)); -->
							
							total_oi_change = total_put_change - total_call_change;
						
							if (total_oi_change == 0)
							{
								cell_obj = newRow.insertCell(10);
								cell_obj.style.backgroundColor="lightpink";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('No Data'));
								i_market_view = "No Data";
							}
							else if(total_oi_change > 400000)
							{
								cell_obj = newRow.insertCell(10);
								cell_obj.style.backgroundColor="lightgreen";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BULLISH'));
								i_market_view = "BULLISH";
							}
							else if(total_oi_change < 400000)
							{
								cell_obj = newRow.insertCell(10);
								cell_obj.style.backgroundColor="#fd0e35";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BEARISH'));
								i_market_view = "BEARISH";
							}
							else if(total_oi_change < 100000)
							{
								cell_obj = newRow.insertCell(10);
								cell_obj.style.backgroundColor="lightgrey";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('Wait'));
								i_market_view = "Wait";
							}
							
							var ce_per = 0;
							if((total_call_change > 0) && (previous_call_oi > 0))
							{
								ce_per = ((total_call_change-previous_call_oi)/previous_call_oi)*100;
							}
							else if((total_call_change < 0) && (previous_call_oi < 0))
							{
								ce_per = ((total_call_change-previous_call_oi)/-previous_call_oi)*100;
							}
							else if((total_call_change > 0) && (previous_call_oi < 0))
							{
								ce_per = ((total_call_change-previous_call_oi)/-previous_call_oi)*100;
							}
							else
							{
								ce_per = ((total_call_change-previous_call_oi)/previous_call_oi)*100;
							}
							if (ce_per <= 0)
							{
								cell_obj = newRow.insertCell(11);
								cell_obj.style.backgroundColor="#ffcccb";
								cell_obj.style.color="red";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
							}
							else
							{
								cell_obj = newRow.insertCell(11);
								cell_obj.style.backgroundColor="lightgreen";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
							}
							
							var pe_per = 0;
							
							if((total_put_change > 0) && (previous_put_oi > 0))
							{
								pe_per = ((total_put_change-previous_put_oi)/previous_put_oi)*100;
							}
							else if((total_put_change < 0) && (previous_put_oi < 0))
							{
								pe_per = ((total_put_change-previous_put_oi)/-previous_put_oi)*100;
							}
							else if((total_put_change > 0) && (previous_put_oi < 0))
							{
								pe_per = ((total_put_change-previous_put_oi)/-previous_put_oi)*100;
							}
							else
							{
								pe_per = ((total_put_change-previous_put_oi)/previous_put_oi)*100;
							}
							if (pe_per <= 0)
							{
								cell_obj = newRow.insertCell(12);
								cell_obj.style.backgroundColor="#ffcccb";
								cell_obj.style.color="red";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
							}
							else
							{
								cell_obj = newRow.insertCell(12);
								cell_obj.style.backgroundColor="lightgreen";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
							}
							
							<!-- var dc_change = ((total_put_change - total_call_change)/total_call_change)*100; -->
							
							<!-- if (dc_change <= 0) -->
							<!-- { -->
								<!-- cell_obj = newRow.insertCell(13); -->
								<!-- cell_obj.style.backgroundColor="#ffcccb"; -->
								<!-- cell_obj.style.color="red"; -->
								<!-- cell_obj.style.textAlign = "center"; -->
								<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
							<!-- } -->
							<!-- else -->
							<!-- { -->
								<!-- cell_obj = newRow.insertCell(13); -->
								<!-- cell_obj.style.backgroundColor="lightgreen"; -->
								<!-- cell_obj.style.color="black"; -->
								<!-- cell_obj.style.textAlign = "center"; -->
								<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
							<!-- } -->
							
							if (pe_per>=0 && ce_per <=0)
							{
								cell_obj = newRow.insertCell(13);
								cell_obj.style.backgroundColor="lightgreen";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BULLISH'));
							}
							else if(pe_per <=0 && ce_per >= 0)
							{
								cell_obj = newRow.insertCell(13);
								cell_obj.style.backgroundColor="#fd0e35";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('BEARISH'));
							}
							else
							{
								cell_obj = newRow.insertCell(13);
								cell_obj.style.backgroundColor="#eedc82";
								cell_obj.style.color="black";
								cell_obj.style.textAlign = "center";
								cell_obj.appendChild(document.createTextNode('Wait'));
							}
							first_record = 1;
							
							previous_call_oi = total_call_change;
							previous_put_oi = total_put_change;
							loop_count = 1;
						}
					});
					
					$("#history_log_table tbody").prepend(newRow);
					geniModeCalculation(4);
				}
				else
				{ 
					<!-- console.log(response.msg); -->
				}
			}
		});	
	};
	
	
	
	
function indianRupee(x)
{
	x=x.toString();
	var lastThree = x.substring(x.length-3);
	var otherNumbers = x.substring(0,x.length-3);
	if(otherNumbers != '')
		lastThree = ',' + lastThree;
	var res = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ",") + lastThree;
	
	return res;
}

	
</script>
<script>
	$( document ).ready(function() 
	{
		
	});
</script>								
<script>								
		<!-- let socket = new WebSocket("wss://javascript.info/article/websocket/demo/hello"); -->
		<!-- let socket = new WebSocket("wss://push.truedata.in:{{port}}?user={{username}}&password={{password}}"); -->

		<!-- socket.onopen = function(e) { -->
			<!-- console.log("[open] Connection established"); -->
			<!-- console.log("Sending to server"); -->
			<!-- socket.send('{"method": "addsymbol", "symbols":["NIFTY 50","NIFTY BANK","MCXCOMPDEX","AARTIIND","BRITANNIA","COLPAL","DMART","EICHERMOT","GILLETTE","HDFCBANK","ICICIBANK","JKTYRE","KAJARIACER","LICHSGFIN","MINDTREE","OFSS","PNB","QUICKHEAL","RELIANCE","SBIN","TCS","UJJIVAN","WIPRO","YESBANK","ZEEL","NIFTY-I","BANKNIFTY-I","UPL-I","VEDL-I","VOLTAS-I","ZEEL-I","CRUDEOIL-I","GOLDM-I","SILVERM-I","COPPER-I", "SILVER-I"]}'); -->
			<!-- socket.send('{"method": "addsymbol", "symbols":["NIFTY 50"]}'); -->
			<!-- socket.send('{"method": "getmarketstatus"}'); -->
		<!-- }; -->

		<!-- socket.onmessage = function(event) { -->
			<!-- console.log(event.data); -->
		<!-- }; -->

		<!-- socket.onclose = function(event) { -->
			<!-- if (event.wasClean) { -->
				<!-- console.log('[close] Connection closed cleanly, code=${event.code} reason=${event.reason}'); -->
			<!-- } else { -->
				<!-- // e.g. server process killed or network down -->
				<!-- // event.code is usually 1006 in this case -->
				<!-- console.log('[close] Connection died'); -->
			<!-- } -->
		<!-- }; -->

		<!-- socket.onerror = function(error) { -->
			<!-- console.log(`[error] ${error.message}`); -->
		<!-- }; -->
		
		
		<!-- Enter Strike pirice Calculation -->
		
			<!-- var new_open = '17950.00'; -->
			<!-- $('#id_open').html('17950.00'); -->
			
			<!-- var enter_strike_price = Math.round(new_open).toString(); -->
			<!-- last2 = enter_strike_price.slice(-2); -->
			<!-- var diff = 0 -->
			<!-- var new_enter_strike_price = 0.0 -->
			<!-- if(last2 > 50) -->
			<!-- { -->
				<!-- diff = 100 - parseInt(last2);	-->
				<!-- new_enter_strike_price = parseInt(enter_strike_price) + diff; -->
			<!-- } -->
			<!-- else if(last2 < 50) -->
			<!-- { -->
				<!-- new_enter_strike_price = enter_strike_price - last2; -->
			<!-- } -->
			<!-- else -->
			<!-- { -->
				<!-- new_enter_strike_price = enter_strike_price; -->
			<!-- } -->
			
			<!-- var arr_low = new Array(); -->
			<!-- var arr_high = new Array(); -->
			<!-- var array_high_val = 0; -->
			<!-- var array_low_val = 0; -->
			
			<!-- var count_temp = 50; -->
			<!-- arr_low.push(parseInt(new_enter_strike_price)); -->
			<!-- for(var i = 0; i<5; i++) -->
			<!-- { -->
				<!-- arr_low.push(parseInt(new_enter_strike_price) - count_temp); -->
				<!-- arr_high.push(parseInt(new_enter_strike_price) + count_temp); -->
				
				<!-- count_temp = count_temp + 50; -->
			<!-- } -->
			<!-- arr_low.reverse(); -->
			<!-- var new_array = arr_low.concat(arr_high); -->
			
			<!-- $.each(new_array , function (key, value)  -->
			<!-- { -->
				<!-- $('#id_enter_strike_price_select').append($('<option>', -->
				<!-- { -->
					<!-- value: value, -->
					<!-- text: value -->
				<!-- })); -->
			<!-- }); -->

			<!-- $("#id_enter_strike_price_select option[value='" + new_enter_strike_price + "']").attr("selected","selected"); -->
			<!-- $('#id_strike_price_1').html(new_enter_strike_price); -->
			<!-- $('#id_strike_price_2').html(parseInt(new_enter_strike_price) + 50); -->
			<!-- $('#id_strike_price_3').html(parseInt(new_enter_strike_price) + 100); -->
		
		$(document.body).on('change','#id_enter_strike_price_select',function(){
			$('#id_strike_price_1').html(this.value);
			$('#id_strike_price_2').html(parseInt(this.value) + 100);
			$('#id_strike_price_3').html(parseInt(this.value) + 200);
			
			$("#id_history_table_body").empty();
			
			$('#id_h_call_change_oi_1').html(this.value);
			$('#id_h_call_change_oi_2').html(parseInt(this.value) + 100);
			$('#id_h_call_change_oi_3').html(parseInt(this.value) + 200);
				
			$('#id_h_put_change_oi_1').html(this.value);
			$('#id_h_put_change_oi_2').html(parseInt(this.value) + 100);
			$('#id_h_put_change_oi_3').html(parseInt(this.value) + 200);
			
			<!-- add_time_arg = parseInt($("#id_time_select option:selected").text()); -->
			<!-- temp_date_time = new Date (new Date().toDateString() + ' ' + '14:19'); -->
			<!-- var strike_price1 = $('#id_h_call_change_oi_1').html(); -->
			<!-- var strike_price2 = $('#id_h_call_change_oi_2').html(); -->
			<!-- var strike_price3 = $('#id_h_call_change_oi_3').html(); -->
			<!-- var log_time = temp_date_time.getHours() + ":" +temp_date_time.getMinutes(); -->
			
			
			strike_price1 = $('#id_h_call_change_oi_1').html();
			strike_price2 = $('#id_h_call_change_oi_2').html();
			strike_price3 = $('#id_h_call_change_oi_3').html();
			<!-- log_time = temp_date_time.getHours() + ":" +temp_date_time.getMinutes(); -->
			
			first_history = 'Yes';
			$.ajax({
				method: "POST",
				url: "/bnf_history_logging_data/",
				data: {
					'strike_price1': strike_price1,
					'strike_price2': strike_price2,
					'strike_price3': strike_price3,
					<!-- 'log_time':log_time, -->
					'first_history': first_history,
				},
				success: function (response) 
				{			   
					if (response.status == '1')
					{
						first_history = 'No';
						
						var tbodyRef = document.getElementById('history_log_table').getElementsByTagName('tbody')[0];
						add_time_arg = parseInt($("#id_time_select option:selected").text());
						var history_count = 0;
						var total_call_change = 0;
						var total_put_change = 0;
						var total_oi_change = 0;
						var first_record = 0;
						var prev_call_change_val = 0;
						var prev_put_change_val = 0;
						var string_time = null;
						var last_spot_price = null;
						
						response.data.forEach(function(value) 
						{	
							if (history_count == add_time_arg)
							{
								history_count = 0;
							}
							if (history_count==0)
							{
								newRow = tbodyRef.insertRow();
								
								cell_obj = newRow.insertCell();
								cell_obj.style.backgroundColor="#FADA5E";
								cell_obj.appendChild(document.createTextNode(value.col1.slice(0, -7)));
								
								string_time = value.col1.slice(0, -7);
								
								cell_obj = newRow.insertCell(1);
								cell_obj.style.backgroundColor="#e8e8d6";
								cell_obj.appendChild(document.createTextNode(indianRupee(value.col2)));
								
								cell_obj = newRow.insertCell(2);
								cell_obj.style.backgroundColor="#e8e8d6";
								cell_obj.appendChild(document.createTextNode(indianRupee(value.col3)));
								
								cell_obj = newRow.insertCell(3);
								cell_obj.style.backgroundColor="#e8e8d6";
								cell_obj.appendChild(document.createTextNode(indianRupee(value.col4)));
								
								
								cell_obj = newRow.insertCell(4);
								cell_obj.style.backgroundColor="#ffcccb";
								cell_obj.style.color="red";
								cell_obj.appendChild(document.createTextNode(indianRupee(value.col5)));
								
								cell_obj = newRow.insertCell(5);
								cell_obj.style.backgroundColor="#ffcccb";
								cell_obj.style.color="red";
								cell_obj.appendChild(document.createTextNode(indianRupee(value.col6)));
								
								cell_obj = newRow.insertCell(6);
								cell_obj.style.backgroundColor="#ffcccb";
								cell_obj.style.color="red";
								cell_obj.appendChild(document.createTextNode(indianRupee(value.col7)));
								
								cell_obj1 = newRow.insertCell(7);
								cell_obj1.style.backgroundColor="#353935";
								cell_obj1.style.textAlign = "center";
								total_call_change = parseInt(value.col2) + parseInt(value.col3) + parseInt(value.col4)
								cell_obj1.appendChild(document.createTextNode(indianRupee(total_call_change)));
								
								cell_obj2 = newRow.insertCell(8);
								cell_obj2.style.backgroundColor="#353935";
								cell_obj2.style.textAlign = "center";
								total_put_change = parseInt(value.col5) + parseInt(value.col6) + parseInt(value.col7)
								cell_obj2.appendChild(document.createTextNode(indianRupee(total_put_change)));
								
								if (total_call_change > total_put_change)
								{
									cell_obj1.style.color="#FF7276";
									cell_obj2.style.color="#FF7276";
								}
								else
								{
									cell_obj2.style.color="lightgreen";
									cell_obj1.style.color="#FF7276";
								}
								
								
								if (first_record > 0)
								{
									cell_obj = newRow.insertCell(9);
									cell_obj.style.textAlign = "center";
									<!-- cell_obj.style.background = "r"; -->
									if (parseFloat(value.col8) > last_spot_price)
									{
										cell_obj.style.background = "lightgreen";
									}
									else
									{
										cell_obj.style.background = "#ffcccb";
										cell_obj.style.color = "red";
									}
									cell_obj.appendChild(document.createTextNode(value.col8));
									
									last_spot_price = parseFloat(value.col8);
								}
								else
								{
									<!-- First Record -->
									cell_obj = newRow.insertCell(9);
									cell_obj.style.textAlign = "center";
									cell_obj.style.background = "lightgreen";
									cell_obj.appendChild(document.createTextNode(value.col8));
									last_spot_price = parseFloat(value.col8);
								}

								<!-- cell_obj = newRow.insertCell(9); -->
								<!-- cell_obj.style.textAlign = "center"; -->
								<!-- cell_obj.appendChild(document.createTextNode(value.col8)); -->
								
								total_oi_change = total_put_change - total_call_change;
								
								if (total_oi_change == 0)
								{
									cell_obj = newRow.insertCell(10);
									cell_obj.style.backgroundColor="lightpink";
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode('No Data'));
									i_market_view = "No Data";
								}
								else if(total_oi_change > 400000)
								{
									cell_obj = newRow.insertCell(10);
									cell_obj.style.backgroundColor="lightgreen";
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode('BULLISH'));
									i_market_view = "BULLISH";
								}
								else if(total_oi_change < 400000)
								{
									cell_obj = newRow.insertCell(10);
									cell_obj.style.backgroundColor="#fd0e35";
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode('BEARISH'));
									i_market_view = "BEARISH";
								}
								else if(total_oi_change < 100000)
								{
									cell_obj = newRow.insertCell(10);
									cell_obj.style.backgroundColor="lightgrey";
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode('Wait'));
									i_market_view = "Wait";
								}
								
								var ce_per = 0;
								if (first_record > 0)
								{
									if((total_call_change > 0) && (prev_call_change_val > 0))
									{
										ce_per = ((total_call_change-prev_call_change_val)/prev_call_change_val)*100;
									}
									else if((total_call_change < 0) && (prev_call_change_val < 0))
									{
										ce_per = ((total_call_change-prev_call_change_val)/-prev_call_change_val)*100;
									}
									else if((total_call_change > 0) && (prev_call_change_val < 0))
									{
										ce_per = ((total_call_change-prev_call_change_val)/-prev_call_change_val)*100;
									}
									else
									{
										ce_per = ((total_call_change-prev_call_change_val)/prev_call_change_val)*100;
									}
									if (ce_per <= 0)
									{
										cell_obj = newRow.insertCell(11);
										cell_obj.style.backgroundColor="#ffcccb";
										cell_obj.style.color="red";
										cell_obj.style.textAlign = "center";
										cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
									}
									else
									{
										cell_obj = newRow.insertCell(11);
										cell_obj.style.backgroundColor="lightgreen";
										cell_obj.style.color="black";
										cell_obj.style.textAlign = "center";
										cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
									}
								}
								else
								{
									cell_obj = newRow.insertCell(11);
									<!-- cell_obj.style.backgroundColor="lightgreen"; -->
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode('-'));
								}
								
								var pe_per = 0;
								if (first_record > 0)
								{
									if((total_put_change > 0) && (prev_put_change_val > 0))
									{
										pe_per = ((total_put_change-prev_put_change_val)/prev_put_change_val)*100;
									}
									else if((total_put_change < 0) && (prev_put_change_val < 0))
									{
										pe_per = ((total_put_change-prev_put_change_val)/-prev_put_change_val)*100;
									}
									else if((total_put_change > 0) && (prev_put_change_val < 0))
									{
										pe_per = ((total_put_change-prev_put_change_val)/-prev_put_change_val)*100;
									}
									else
									{
										pe_per = ((total_put_change-prev_put_change_val)/prev_put_change_val)*100;
									}
									if (pe_per <= 0)
									{
										cell_obj = newRow.insertCell(12);
										cell_obj.style.backgroundColor="#ffcccb";
										cell_obj.style.color="red";
										cell_obj.style.textAlign = "center";
										cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
									}
									else
									{
										cell_obj = newRow.insertCell(12);
										cell_obj.style.backgroundColor="lightgreen";
										cell_obj.style.color="black";
										cell_obj.style.textAlign = "center";
										cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
									}
								}
								else
								{
									cell_obj = newRow.insertCell(11);
									<!-- cell_obj.style.backgroundColor="lightgreen"; -->
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode('-'));
								}
								
								<!-- var dc_change = ((total_put_change - total_call_change)/total_call_change)*100; -->
								
								<!-- if (dc_change <= 0) -->
								<!-- { -->
									<!-- cell_obj = newRow.insertCell(13); -->
									<!-- cell_obj.style.backgroundColor="#ffcccb"; -->
									<!-- cell_obj.style.color="red"; -->
									<!-- cell_obj.style.textAlign = "center"; -->
									<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
								<!-- } -->
								<!-- else -->
								<!-- { -->
									<!-- cell_obj = newRow.insertCell(13); -->
									<!-- cell_obj.style.backgroundColor="lightgreen"; -->
									<!-- cell_obj.style.color="black"; -->
									<!-- cell_obj.style.textAlign = "center"; -->
									<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
								<!-- } -->
								
								if (pe_per>=0 && ce_per <=0)
								{
									cell_obj = newRow.insertCell(13);
									cell_obj.style.backgroundColor="lightgreen";
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode('BULLISH'));
								}
								else if(pe_per <=0 && ce_per >= 0)
								{
									cell_obj = newRow.insertCell(13);
									cell_obj.style.backgroundColor="#fd0e35";
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode('BEARISH'));
								}
								else
								{
									cell_obj = newRow.insertCell(13);
									cell_obj.style.backgroundColor="#eedc82";
									cell_obj.style.color="black";
									cell_obj.style.textAlign = "center";
									cell_obj.appendChild(document.createTextNode('Wait'));
								}
								first_record = 1;
								$("#history_log_table tbody").prepend(newRow);
								history_count = history_count + 1;
								prev_call_change_val = total_call_change;
								prev_put_change_val = total_put_change;
								previous_call_oi = total_call_change;
								previous_put_oi = total_put_change;
							}
							else
							{
								history_count = history_count + 1;
							}
						});
						<!-- console.log(response.data); -->
						
						temp_date_time = new Date (new Date().toDateString() + ' ' + string_time);
						temp_date_time.setMinutes( temp_date_time.getMinutes() + add_time_arg );
						run = setInterval(request , history_data_time);
						
						bul_count = 0;
						bear_count = 0;
						bullish_status = false;
						bearish_status = false;
						other_status = false;
						$('#id_led_box').hide();
						$('#id_led_box_2').hide();
						
						geniModeCalculation(5);
						
						global_last_spot_price = last_spot_price;
						<!-- alert(global_last_spot_price); -->
					}
					else
					{
						<!-- console.log(response.msg); -->
					}
				}
			});	
			
			<!-- temp_date_time = new Date (new Date().toDateString() + ' ' + '9:30'); -->
		});
		
		<!-- End Enter Strike price calculation -->
		
		var target = 0;
		var target1 = 0;
		var other_target = 0;
		
		var stop_loss = 0;
		var stop_loss1 = 0;

		var count_enter_strike_price = 0;
		
		let { createApp } = Vue;

		let CoinsApp = {
			data(){
				return {
					coin: 'just a coin',
					coins: null,
				}
			},
			created(){
				
				
				let socket = new WebSocket(`ws://${window.location.host}/ws/bankNifty/`);

				let _this = this;
				
				var ltp_price_val = 0;
				var gann_count = 0;

				socket.onmessage = function(event){
				
					<!-- Gann Angle Caluculations -->
	
						var now_for_gann = new Date();
						var datetime_for_gann = new Date (new Date().toDateString() + ' ' + '09:30');
						
						if (gann_count == 0)
						{
							if (now_for_gann.getTime() >= datetime_for_gann.getTime()) 
							{
								$.ajax({
									method: "POST",
									url: "/get_gann_values/",
									data: {
										'type': 'BANKNIFTY',
									},
									success: function (response) 
									{			   
										if (response.status == "1")
										{
											var gann_high = parseFloat(response.data[0].high_val);
											var gann_low = parseFloat(response.data[0].low_val);
											
											var gann_high_360 = ((Math.sqrt(parseFloat(gann_low)) + 2) * (Math.sqrt(parseFloat(gann_low)) + 2)).toFixed(2);
											
											//<!-- Caluculation for long position  -->
											
												var gann_high_15_incr = ((gann_high_360-gann_low)/24).toFixed(2);
												
												//<!-- var gann_high_360_incr = (gann_high_360-gann_low).toFixed(2); -->
												
												var gann_high_0 = gann_low;
												
												var gann_high_15 = parseFloat(gann_low) + parseFloat(gann_high_15_incr)
												
												var gann_high_30 = parseFloat(gann_high_15) + parseFloat(gann_high_15_incr)
												
												var gann_high_45 = parseFloat(gann_high_30) + parseFloat(gann_high_15_incr)
												
												var gann_high_60 = parseFloat(gann_high_45) + parseFloat(gann_high_15_incr)
												
												var gann_high_75 = parseFloat(gann_high_60) + parseFloat(gann_high_15_incr)
												
												var gann_high_90 = parseFloat(gann_high_75) + parseFloat(gann_high_15_incr)
												
												var gann_high_105 = parseFloat(gann_high_90) + parseFloat(gann_high_15_incr)
												
												var gann_high_120 = parseFloat(gann_high_105) + parseFloat(gann_high_15_incr)
												
												var gann_high_135 = parseFloat(gann_high_120) + parseFloat(gann_high_15_incr)
												
												<!-- $('#id_gann_high').html(gann_high); -->
												<!-- $('#id_gann_low').html(gann_low); -->
												
												$('#id_g_90_high').html((Math.round(gann_high_90 * 4) / 4).toFixed(2));
												$('#id_g_135_high').html((Math.round(gann_high_135 * 4) / 4).toFixed(2));
												$('#id_g_45_high').html((Math.round(gann_high_45 * 4) / 4).toFixed(2));
												
												
											
											//<!-- End Caluculation for long position  -->
											
											//<!-- Caluculation for short position  -->
											
												var gann_low_360 = ((Math.sqrt(parseFloat(gann_high)) - 2) * (Math.sqrt(parseFloat(gann_high)) - 2)).toFixed(5);
												
												var gann_low_15_incr = ((gann_low_360-gann_high)/24).toFixed(2);
												
												var gann_low_0 = gann_high;
												
												var gann_low_15 = parseFloat(gann_high) + parseFloat(gann_low_15_incr)
												
												var gann_low_30 = parseFloat(gann_low_15) + parseFloat(gann_low_15_incr)
												
												var gann_low_45 = parseFloat(gann_low_30) + parseFloat(gann_low_15_incr)
												
												var gann_low_60 = parseFloat(gann_low_45) + parseFloat(gann_low_15_incr)
												
												var gann_low_75 = parseFloat(gann_low_60) + parseFloat(gann_low_15_incr)
												
												var gann_low_90 = parseFloat(gann_low_75) + parseFloat(gann_low_15_incr)
												
												var gann_low_105 = parseFloat(gann_low_90) + parseFloat(gann_low_15_incr)
												var gann_low_120 = parseFloat(gann_low_105) + parseFloat(gann_low_15_incr)
												var gann_low_135 = parseFloat(gann_low_120) + parseFloat(gann_low_15_incr)
												
												$('#id_g_90_low').html((Math.round(gann_low_90 * 4) / 4).toFixed(2));
												$('#id_g_135_low').html((Math.round(gann_low_135 * 4) / 4).toFixed(2));
												$('#id_g_45_low').html((Math.round(gann_low_45 * 4) / 4).toFixed(2));
												
												gann_count = 1;
										}
										else
										{
											//<!--// alert(response.msg); -->
										}
									}
								});
							}
						}
						//<!-- End Caluculation for short position  -->

					<!-- Gann Angle Caluculations --> 
				
					_this.coins = JSON.parse(event.data);
					<!-- console.log(_this.coins); -->
					
					<!-- console.log(_this.coins['connect']); -->
					
					<!-- Nifty Dashboard -->
					
					live_data_dict = JSON.parse(_this.coins['live_data']);
					
					<!-- console.log(live_data_dict); -->
					
					if(live_data_dict['symbol']=='BANKNIFTY-I')
					{
						$('#id_nifty_i').html((live_data_dict['ltp']).toFixed(2));
					}
					
					if(live_data_dict['symbol']=='INDIA VIX')
					{
						$('#id_india_vix').html((live_data_dict['ltp']).toFixed(2));
					}
					
					if(live_data_dict['symbol']=='NIFTY BANK')
					{
						var high_val = parseFloat((live_data_dict['day_high'])).toFixed(2);
						var low_val = parseFloat((live_data_dict['day_low'])).toFixed(2);
						ltp_price_val = parseFloat((live_data_dict['ltp'])).toFixed(2);
						var prev_day_close_val = parseFloat((live_data_dict['prev_day_close'])).toFixed(2);
						var day_open_val = parseFloat((live_data_dict['day_open'])).toFixed(2);
						var low_val = parseFloat((live_data_dict['day_low'])).toFixed(2);
						<!-- var day_open_val = 17921.00; -->
						$('#id_symbol').html(live_data_dict['symbol']);	// Symbol
						
						if (ltp_price_val > prev_day_close_val)
						{
							document.getElementById('id_price').style.color = 'green';
						}
						else
						{
							document.getElementById('id_price').style.color = 'red';
						}
						$('#id_price').html(ltp_price_val);		// Price
						$('#id_pclose').html(prev_day_close_val);	// Previous day close
						$('#id_open').html(day_open_val);	// open
						$('#id_high').html(high_val);	// High
						$('#id_low').html(low_val);		// low
						
						$('#id_last_update_time').html(live_data_dict['timestamp'].substr(11, 5));		// previous updated time
						
						$('#id_change').html(live_data_dict['_change_perc'].toFixed(2));
						
						
						
						var pivot_val = ((live_data_dict['prev_day_close'] + live_data_dict['day_high'] + live_data_dict['day_low'])/3).toFixed(2)
						$('#id_pivot').html(pivot_val);		// Pivot
						<!-- pivot =  (P.close+High+Low)/3 -->
						
						<!-- R1 = (2*Pivot)-Low -->
						$('#id_r1').html(((2*pivot_val)-live_data_dict['day_low']).toFixed(2));	//R1
						
						<!-- R2 = Pivot+(High-Low) -->
						<!-- var r2_val	 = parseFloat(high_val - low_val).toFixed(2);		//R2 -->
						<!-- console.log(r2_val); -->
						<!-- var new_pivot_val = parseFloat(pivot_val).toFixed(2); -->
						<!-- console.log(new_pivot_val); -->
						<!-- var new_r2_val = new_pivot_val + r2_val; -->
						<!-- console.log(new_r2_val); -->
						<!-- console.log(pivot_val); -->
						<!-- console.log(high_val); -->
						<!-- console.log(low_val); -->
						<!-- var r2_val	 = (pivot_val + (high_val - low_val)); -->
						var r2_val	= math.sum(pivot_val, (high_val - low_val)).toFixed(2);
						$('#id_r2').html(r2_val);
						
						
						<!-- S1 = (2*Pivot)-High -->
						$('#id_s1').html(((2*pivot_val)-live_data_dict['day_high']).toFixed(2));	//S1
						
						<!-- S2 = Pivot-(High-Low) -->
						var s2_val	= (pivot_val - (high_val - low_val)).toFixed(2);		//S2
						$('#id_s2').html(s2_val);
						
						<!-- Reversal Time -->
						<!-- PTD=MOD((SQRT(OPEN)*180)-225,360) -->
						<!-- Time= PTD/60 -->
						<!-- Total Time = 9+ Time -->
						<!-- MID1= MID(Total Time,1,2)/24 -->
						<!-- Mid2 =MID(Total Time,3,2)/27 -->
						<!-- Reversal Time= MID1+MID2 -->
						
						var PTD = math.mod((Math.sqrt(day_open_val) * 180)-225, 360);
						var Time = PTD/60;	
						var Total_Time = (9 + Time).toFixed(2);					
						var MID1 = Total_Time.substring(0, 2)/24;
						var MID2 = Total_Time.substring(5, 2)/27;
						 
						var hour_val = (Math.round(MID1*24));
						var min_val = (Math.round(MID2*1440));
						
						<!-- console.log(parseFloat(MID1) + parseFloat(MID2)); -->
						
						$('#id_reversal_time_1').html(hour_val + ':' + min_val);
						$('#id_reversal_time_2').html('0:' + min_val);
						
							
						
						<!-- Enter Strike Price Calculation -->
						if (count_enter_strike_price == 0)
						{
							var enter_strike_price = Math.round(day_open_val).toString();
							<!-- var enter_strike_price = '17590'; -->
							last2 = enter_strike_price.slice(-2);
							var diff = 0;
							var new_enter_strike_price = 0.0;
							if(last2 >= 90)
							{
								diff = 100 - parseInt(last2); 
								new_enter_strike_price = parseInt(enter_strike_price) + diff;
							}
							else if(last2 < 90)
							{
								new_enter_strike_price = enter_strike_price - last2;
							}
							else
							{
								new_enter_strike_price = enter_strike_price;
							}
							
							var arr_low = new Array();
							var arr_high = new Array();
							var array_high_val = 0;
							var array_low_val = 0;
							
							var count_temp = 100;
							arr_low.push(parseInt(new_enter_strike_price));
							for(var i = 0; i<5; i++)
							{
								arr_low.push(parseInt(new_enter_strike_price) - count_temp);
								<!-- if (i < 4) -->
								<!-- { -->
								arr_high.push(parseInt(new_enter_strike_price) + count_temp);
								<!-- } -->
								
								count_temp = count_temp + 100;
							}
							arr_low.reverse();
							var new_array = arr_low.concat(arr_high);
							
							$.each(new_array , function (key, value) 
							{
								$('#id_enter_strike_price_select').append($('<option>',
								{
									value: value,
									text: value 
								}));
							});

							$("#id_enter_strike_price_select option[value='" + new_enter_strike_price + "']").attr("selected","selected");
							$('#id_strike_price_1').html(new_enter_strike_price);
							$('#id_strike_price_2').html(parseInt(new_enter_strike_price) + 100);
							$('#id_strike_price_3').html(parseInt(new_enter_strike_price) + 200);
							
							$('#id_h_call_change_oi_1').html(new_enter_strike_price);
							$('#id_h_call_change_oi_2').html(parseInt(new_enter_strike_price) + 100);
							$('#id_h_call_change_oi_3').html(parseInt(new_enter_strike_price + 200));
							
							$('#id_h_put_change_oi_1').html(new_enter_strike_price);
							$('#id_h_put_change_oi_2').html(parseInt(new_enter_strike_price) + 100);
							$('#id_h_put_change_oi_3').html(parseInt(new_enter_strike_price) + 200);
							 
							
							<!-- first time history log -->
							
							<!-- log_time = temp_date_time.getHours() + ":" +temp_date_time.getMinutes(); -->
							
							strike_price1 = $('#id_h_call_change_oi_1').html();
							strike_price2 = $('#id_h_call_change_oi_2').html();
							strike_price3 = $('#id_h_call_change_oi_3').html();
							<!-- log_time = temp_date_time.getHours() + ":" +temp_date_time.getMinutes(); -->
							
							$.ajax({
								method: "POST",
								url: "/bnf_history_logging_data/",
								data: {
									'strike_price1': strike_price1,
									'strike_price2': strike_price2,
									'strike_price3': strike_price3,
									<!-- 'log_time':log_time, -->
									'first_history': first_history,
								},
								success: function (response) 
								{			   
									if (response.status == '1')
									{
										first_history = 'No';
										
										var tbodyRef = document.getElementById('history_log_table').getElementsByTagName('tbody')[0];
										add_time_arg = parseInt($("#id_time_select option:selected").text());
										var history_count = 0;
										var total_call_change = 0;
										var total_put_change = 0;
										var total_oi_change = 0;
										var first_record = 0;
										var prev_call_change_val = 0;
										var prev_put_change_val = 0;
										var string_time = null;
										var last_spot_price = null;
										response.data.forEach(function(value) 
										{	
											if (history_count == add_time_arg)
											{
												history_count = 0;
											}
											if (history_count==0)
											{
												newRow = tbodyRef.insertRow();
												
												cell_obj = newRow.insertCell();
												cell_obj.style.backgroundColor="#FADA5E";
												cell_obj.appendChild(document.createTextNode(value.col1.slice(0, -7)));
												
												string_time = value.col1.slice(0, -7);
												
												cell_obj = newRow.insertCell(1);
												cell_obj.style.backgroundColor="#e8e8d6";
												cell_obj.appendChild(document.createTextNode(indianRupee(value.col2)));
												
												cell_obj = newRow.insertCell(2);
												cell_obj.style.backgroundColor="#e8e8d6";
												cell_obj.appendChild(document.createTextNode(indianRupee(value.col3)));
												
												cell_obj = newRow.insertCell(3);
												cell_obj.style.backgroundColor="#e8e8d6";
												cell_obj.appendChild(document.createTextNode(indianRupee(value.col4)));
												
												
												cell_obj = newRow.insertCell(4);
												cell_obj.style.backgroundColor="#ffcccb";
												cell_obj.style.color="red";
												cell_obj.appendChild(document.createTextNode(indianRupee(value.col5)));
												
												cell_obj = newRow.insertCell(5);
												cell_obj.style.backgroundColor="#ffcccb";
												cell_obj.style.color="red";
												cell_obj.appendChild(document.createTextNode(indianRupee(value.col6)));
												
												cell_obj = newRow.insertCell(6);
												cell_obj.style.backgroundColor="#ffcccb";
												cell_obj.style.color="red";
												cell_obj.appendChild(document.createTextNode(indianRupee(value.col7)));
												
												total_call_change = parseInt(value.col2) + parseInt(value.col3) + parseInt(value.col4)
												total_put_change = parseInt(value.col5) + parseInt(value.col6) + parseInt(value.col7)
												
												cell_obj1 = newRow.insertCell(7);
												cell_obj1.style.background="#353935";
												cell_obj1.style.textAlign = "center";
												cell_obj1.appendChild(document.createTextNode(indianRupee(total_call_change)));
												
												cell_obj2 = newRow.insertCell(8);
												cell_obj2.style.background="#353935";
												cell_obj2.style.textAlign = "center";
												cell_obj2.appendChild(document.createTextNode(indianRupee(total_put_change)));
												
												if (total_call_change > total_put_change)
												{
													cell_obj1.style.color="#FF7276";
													cell_obj2.style.color="#FF7276";
												}
												else
												{
													cell_obj2.style.color="lightgreen";
													cell_obj1.style.color="#FF7276";
												}
												
												
												if (first_record > 0)
												{
													cell_obj = newRow.insertCell(9);
													cell_obj.style.textAlign = "center";
													<!-- cell_obj.style.background = "r"; -->
													if (parseFloat(value.col8) > last_spot_price)
													{
														cell_obj.style.background = "lightgreen";
													}
													else
													{
														cell_obj.style.background = "#ffcccb";
														cell_obj.style.color = "red";
													}
													cell_obj.appendChild(document.createTextNode(value.col8));
													
													last_spot_price = parseFloat(value.col8);
												}
												else
												{
													<!-- First Record -->
													cell_obj = newRow.insertCell(9);
													cell_obj.style.textAlign = "center";
													cell_obj.style.background = "lightgreen";
													cell_obj.appendChild(document.createTextNode(value.col8));
													last_spot_price = parseFloat(value.col8);
												}

												total_oi_change = total_put_change - total_call_change;
												
												if (total_oi_change == 0)
												{
													cell_obj = newRow.insertCell(10);
													cell_obj.style.backgroundColor="lightpink";
													cell_obj.style.color="black";
													cell_obj.style.textAlign = "center";
													cell_obj.appendChild(document.createTextNode('No Data'));
													i_market_view = 'No Data';
												}
												else if(total_oi_change > 400000)
												{
													cell_obj = newRow.insertCell(10);
													cell_obj.style.backgroundColor="lightgreen";
													cell_obj.style.color="black";
													cell_obj.style.textAlign = "center";
													cell_obj.appendChild(document.createTextNode('BULLISH'));
													i_market_view = 'BULLISH';
												}
												else if(total_oi_change < 400000)
												{
													cell_obj = newRow.insertCell(10);
													cell_obj.style.backgroundColor="#fd0e35";
													cell_obj.style.color="black";
													cell_obj.style.textAlign = "center";
													cell_obj.appendChild(document.createTextNode('BEARISH'));
													i_market_view = 'BEARISH';
												}
												else if(total_oi_change < 100000)
												{
													cell_obj = newRow.insertCell(10);
													cell_obj.style.backgroundColor="lightgrey";
													cell_obj.style.color="black";
													cell_obj.style.textAlign = "center";
													cell_obj.appendChild(document.createTextNode('Wait'));
													i_market_view = 'Wait';
												}
												
												var ce_per = 0;
												if (first_record > 0)
												{
													if((total_call_change > 0) && (prev_call_change_val > 0))
													{
														ce_per = ((total_call_change-prev_call_change_val)/prev_call_change_val)*100;
													}
													else if((total_call_change < 0) && (prev_call_change_val < 0))
													{
														ce_per = ((total_call_change-prev_call_change_val)/-prev_call_change_val)*100;
													}
													else if((total_call_change > 0) && (prev_call_change_val < 0))
													{
														ce_per = ((total_call_change-prev_call_change_val)/-prev_call_change_val)*100;
													}
													else
													{
														ce_per = ((total_call_change-prev_call_change_val)/prev_call_change_val)*100;
													}
													if (ce_per <= 0)
													{
														cell_obj = newRow.insertCell(11);
														cell_obj.style.backgroundColor="#ffcccb";
														cell_obj.style.color="red";
														cell_obj.style.textAlign = "center";
														cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
													}
													else
													{
														cell_obj = newRow.insertCell(11);
														cell_obj.style.backgroundColor="lightgreen";
														cell_obj.style.color="black";
														cell_obj.style.textAlign = "center";
														cell_obj.appendChild(document.createTextNode(ce_per.toFixed(2)+'%'));
													}
												}
												else
												{
													cell_obj = newRow.insertCell(11);
													<!-- cell_obj.style.backgroundColor="lightgreen"; -->
													cell_obj.style.color="black";
													cell_obj.style.textAlign = "center";
													cell_obj.appendChild(document.createTextNode('-'));
												}
												
												var pe_per = 0;
												if (first_record > 0)
												{
													if((total_put_change > 0) && (prev_put_change_val > 0))
													{
														pe_per = ((total_put_change-prev_put_change_val)/prev_put_change_val)*100;
													}
													else if((total_put_change < 0) && (prev_put_change_val < 0))
													{
														pe_per = ((total_put_change-prev_put_change_val)/-prev_put_change_val)*100;
													}
													else if((total_put_change > 0) && (prev_put_change_val < 0))
													{
														pe_per = ((total_put_change-prev_put_change_val)/-prev_put_change_val)*100;
													}
													else
													{
														pe_per = ((total_put_change-prev_put_change_val)/prev_put_change_val)*100;
													}
													if (pe_per <= 0)
													{
														cell_obj = newRow.insertCell(12);
														cell_obj.style.backgroundColor="#ffcccb";
														cell_obj.style.color="red";
														cell_obj.style.textAlign = "center";
														cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
													}
													else
													{
														cell_obj = newRow.insertCell(12);
														cell_obj.style.backgroundColor="lightgreen";
														cell_obj.style.color="black";
														cell_obj.style.textAlign = "center";
														cell_obj.appendChild(document.createTextNode(pe_per.toFixed(2)+'%'));
													}
												}
												else
												{
													cell_obj = newRow.insertCell(11);
													<!-- cell_obj.style.backgroundColor="lightgreen"; -->
													cell_obj.style.color="black";
													cell_obj.style.textAlign = "center";
													cell_obj.appendChild(document.createTextNode('-'));
												}
												
												<!-- var dc_change = ((total_put_change - total_call_change)/total_call_change)*100; -->
												
												<!-- if (dc_change <= 0) -->
												<!-- { -->
													<!-- cell_obj = newRow.insertCell(13); -->
													<!-- cell_obj.style.backgroundColor="#ffcccb"; -->
													<!-- cell_obj.style.color="red"; -->
													<!-- cell_obj.style.textAlign = "center"; -->
													<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
												<!-- } -->
												<!-- else -->
												<!-- { -->
													<!-- cell_obj = newRow.insertCell(13); -->
													<!-- cell_obj.style.backgroundColor="lightgreen"; -->
													<!-- cell_obj.style.color="black"; -->
													<!-- cell_obj.style.textAlign = "center"; -->
													<!-- cell_obj.appendChild(document.createTextNode(dc_change.toFixed(2)+'%')); -->
												<!-- } -->
												
												if (pe_per>=0 && ce_per <=0)
												{
													cell_obj = newRow.insertCell(13);
													cell_obj.style.backgroundColor="lightgreen";
													cell_obj.style.color="black";
													cell_obj.style.textAlign = "center";
													cell_obj.appendChild(document.createTextNode('BULLISH'));
												}
												else if(pe_per <=0 && ce_per >= 0)
												{
													cell_obj = newRow.insertCell(13);
													cell_obj.style.backgroundColor="#fd0e35";
													cell_obj.style.color="black";
													cell_obj.style.textAlign = "center";
													cell_obj.appendChild(document.createTextNode('BEARISH'));
												}
												else
												{
													cell_obj = newRow.insertCell(13);
													cell_obj.style.backgroundColor="#eedc82";
													cell_obj.style.color="black";
													cell_obj.style.textAlign = "center";
													cell_obj.appendChild(document.createTextNode('Wait'));
												}
												first_record = 1;
												$("#history_log_table tbody").prepend(newRow);
												history_count = history_count + 1;
												prev_call_change_val = total_call_change;
												prev_put_change_val = total_put_change;
												previous_call_oi = total_call_change;
												previous_put_oi = total_put_change;
											}
											else
											{
												history_count = history_count + 1;
											}
										});
										<!-- console.log(response.data); -->
										temp_date_time = new Date (new Date().toDateString() + ' ' + string_time);
										temp_date_time.setMinutes( temp_date_time.getMinutes() + add_time_arg );
										run = setInterval(request , history_data_time);
										global_last_spot_price = last_spot_price;
										
										setTimeout(function(){
											geniModeCalculation(6);
										},2000);
									}
									else
									{
										<!-- console.log(response.msg); -->
										temp_date_time = new Date (new Date().toDateString() + ' ' + '09:15');
										run = setInterval(request , history_data_time)
									}
								}
							});	
							
							<!-- end first time history log -->
						
						<!-- end Enter strike price calculation -->
							count_enter_strike_price = 1;
						}
					}
					<!-- end Nifty Dashboard -->
					
					<!-- option chain analysis -->
					
						<!-- small chain analysis -->
						
							var new_ltp_val = Math.round(ltp_price_val).toString();
							last2 = new_ltp_val.slice(-2);
							var diff = 0;
							var new_ltp_val_1 = 0.0;
							if(last2 > 50)
							{
								diff = 100 - parseInt(last2); 
								new_ltp_val_1 = parseInt(new_ltp_val) + diff;
							}
							else if(last2 < 50)
							{
								new_ltp_val_1 = new_ltp_val - last2;
							}
							else
							{
								new_ltp_val_1 = new_ltp_val;
							}
							
							var arr_low = new Array();
							var arr_high = new Array();
							var array_high_val = 0;
							var array_low_val = 0;
							
							var count_temp = 100;
							arr_low.push(parseInt(new_ltp_val_1));
							for(var i = 0; i<4; i++)
							{
								arr_low.push(parseInt(new_ltp_val_1) - count_temp);
								arr_high.push(parseInt(new_ltp_val_1) + count_temp);
								
								count_temp = count_temp + 100;
							}
							arr_low.reverse();
							var new_array = arr_low.concat(arr_high);
							
							<!-- console.log(new_array[0]); -->
						
						<!-- end small chain analysis -->
					
						_this.option_data = JSON.parse(_this.coins['option_chain']);
						
						<!-- console.log(_this.option_data); -->
						
						var tbodyRef = document.getElementById('option_analysis_table').getElementsByTagName('tbody')[0];
						
						$("#tbodyid").empty();
						
						var count_row = 0;
						var newRow = null;
						var max_call_oi = 0;
						var max_call_oi_row = null;
						var max_put_oi = 0;
						var max_put_oi_row = null;
						
						var max_call_change_oi = 0;
						var max_call_change_oi_row = null;
						var max_put_change_oi = 0;
						var max_put_change_oi_row = null;
						
						var strike_price_1 = $('#id_strike_price_1').text();
						var strike_price_2 = $('#id_strike_price_2').text();
						var strike_price_3 = $('#id_strike_price_3').text();
						
						var SP1_c_change_oi = null;
						var SP2_c_change_oi = null;
						var SP3_c_change_oi = null;
						
						var sp1_p_change_oi = null;
						var sp2_p_change_oi = null;
						var sp3_p_change_oi = null;
						
						var sp1_c_ltp = null;
						var sp2_c_ltp = null;
						var sp3_p_ltp = null;
						var strike_count = 0;
						var strike_true_status = 0;
						var strike_call_oi = 0;
						var strike_put_oi = 0;
						var strike_call_change_oi = 0;
						var strike_put_change_oi = 0;
						
						var total_pcr_call_oi = 0;
						var total_pcr_put_oi = 0;

						_this.option_data.forEach(function(value) 
						{
							//<!-- console.log('value : ' + value.strike); -->
							// Insert a row at the end of table
							
							if (count_row == 0)
							{
								newRow = tbodyRef.insertRow();
							}

							// Insert a cell at the end of the row
							if (value.type == "CE")
							{	
								total_pcr_call_oi = total_pcr_call_oi + parseFloat(value.oi);
								sbu_obj = newRow.insertCell();
								sbu_obj.style.backgroundColor="red";
								sbu_obj.appendChild(document.createTextNode('Short Build Up'));
								newRow.insertCell().appendChild(document.createTextNode(indianRupee(value.oi)));
								if (value.oi > max_call_oi)
								{
									max_call_oi = value.oi;
									max_call_oi_row = value;
								}
								newRow.insertCell().appendChild(document.createTextNode(indianRupee(value.oi_change)));
								if (value.oi_change > max_call_change_oi)
								{
									max_call_change_oi = value.oi_change;
									max_call_change_oi_row = value;
								}
								newRow.insertCell().appendChild(document.createTextNode(indianRupee(parseFloat(value.ltq))));
								newRow.insertCell().appendChild(document.createTextNode(parseFloat(value.price_change).toFixed(2)));
								newRow.insertCell().appendChild(document.createTextNode(value.ltp));
								newRow.insertCell().appendChild(document.createTextNode('-'));
								strike_cell_obj = newRow.insertCell();
								strike_cell_obj.style.backgroundColor="#c6e6f5";
								strike_cell_obj.appendChild(document.createTextNode(value.strike));
								
								if (strike_count < 9)
								{
									if (new_array[strike_count] == value.strike)
									{
										strike_true_status = 1;
										strike_call_oi = value.oi;
										strike_call_change_oi = value.oi_change;
									}
								}
								
								if (value.strike == strike_price_1)
								{
									sp1_c_change_oi = value.oi_change;
									sp1_c_ltp = value.ltp;
								}
								else if(value.strike == strike_price_2)
								{
									sp2_c_change_oi = value.oi_change;
									sp2_c_ltp = value.ltp;
								}
								else if(value.strike == strike_price_3)
								{
									sp3_c_change_oi = value.oi_change;									
								}
								count_row = 1;
							}
							else
							{
								total_pcr_put_oi = total_pcr_put_oi + parseFloat(value.oi);
									
								if (strike_true_status == 1)
								{
									strike_true_status = 0;
									strike_put_oi = value.oi;
									strike_put_change_oi = value.oi_change;
									
									if(new_ltp_val_1 == new_array[strike_count])
									{
										$('#id_strike_small_' + (parseInt(strike_count)+1)).html(new_array[strike_count]);
										$('#id_strike_small_' + (parseInt(strike_count)+1)).css("background-color", "#fffdaf");
										$('#id_pcr_' + (parseInt(strike_count)+1)).html(((parseFloat(strike_put_oi)/parseFloat(strike_call_oi)).toFixed(2)));
										$('#id_pcr_' + (parseInt(strike_count)+1)).css("background-color", "#fffdaf");
									}
									else
									{
										$('#id_strike_small_' + (parseInt(strike_count)+1)).html(new_array[strike_count]);
										$('#id_pcr_' + (parseInt(strike_count)+1)).html(((parseFloat(strike_put_oi)/parseFloat(strike_call_oi)).toFixed(2)));
									}
									
									<!-- $('#id_strike_small_' + (parseInt(strike_count)+1)).html(new_array[strike_count]); -->
									<!-- $('#id_pcr_' + (parseInt(strike_count)+1)).html(((parseFloat(strike_put_oi)/parseFloat(strike_call_oi)).toFixed(2))); -->
									
									var net_change_val = (parseFloat(strike_put_change_oi)-parseFloat(strike_call_change_oi).toFixed(2));
									$('#id_net_change_' + (parseInt(strike_count)+1)).html(indianRupee(net_change_val));
									if (net_change_val >= 0)
									{
										$('#id_net_change_' + (parseInt(strike_count)+1)).css("color", "green");
										$('#id_net_change_' + (parseInt(strike_count)+1)).css("background-color", "	#a3e5c4");
									}
									else
									{
										$('#id_net_change_' + (parseInt(strike_count)+1)).css("color", "red");
										$('#id_net_change_' + (parseInt(strike_count)+1)).css("background-color", "#FFCCCB");
									}
									
									strike_count = strike_count + 1;
								}
								
								if (value.strike == strike_price_1)
								{
									sp1_p_change_oi = value.oi_change;
								}
								else if(value.strike == strike_price_2)
								{
									sp2_p_change_oi = value.oi_change;
								}
								else if(value.strike == strike_price_3)
								{
									sp3_p_change_oi = value.oi_change;									
									sp3_p_ltp = value.ltp;
								}
								newRow.insertCell().appendChild(document.createTextNode('-'));
								newRow.insertCell().appendChild(document.createTextNode(value.ltp));
								newRow.insertCell().appendChild(document.createTextNode(parseFloat(value.price_change).toFixed(2)));
								newRow.insertCell().appendChild(document.createTextNode(indianRupee(parseFloat(value.ltq))));
								newRow.insertCell().appendChild(document.createTextNode(indianRupee(value.oi_change)));
								if (value.oi_change > max_put_change_oi)
								{
									max_put_change_oi = value.oi_change;
									max_put_change_oi_row = value;
								}
								newRow.insertCell().appendChild(document.createTextNode(indianRupee(value.oi)));
								if (value.oi > max_put_oi)
								{
									max_put_oi = value.oi;
									max_put_oi_row = value;
								}
								lbu_obj = newRow.insertCell();
								lbu_obj.style.backgroundColor="red";
								lbu_obj.appendChild(document.createTextNode('Long Build Up'));
								count_row = 0;
							}
							<!-- console.log('strike_count' + strike_count + ' put oi ' + strike_put_oi + 'call ' + strike_call_oi); -->
							
							<!-- var newCell2 = newRow.insertCell(); -->
							

							// Append a text node to the cell  		
							<!-- var newText = document.createTextNode(value.strike); -->
							<!-- newCell.appendChild(newText); -->
						});
						
						var above_pcr_value = ((parseFloat(total_pcr_put_oi)/parseFloat(total_pcr_call_oi)).toFixed(2))
						
						if (above_pcr_value >= 0.5 && above_pcr_value < 0.7)
						{
							$('#id_pcr').html('OVERSOLD');
						}
						else if(above_pcr_value >= 0.5 && above_pcr_value < 1.5)
						{
							$('#id_pcr').html('OVERBOUGHT');
						}
						else
						{
							$('#id_pcr').html('NEUTRAL');
						}
						
						$('#id_call_chng_oi_1').html(indianRupee(sp1_c_change_oi));
						$('#id_call_chng_oi_2').html(indianRupee(sp2_c_change_oi));
						$('#id_call_chng_oi_3').html(indianRupee(sp3_c_change_oi));
						
						$('#id_put_chng_oi_1').html(indianRupee(sp1_p_change_oi));
						$('#id_put_chng_oi_2').html(indianRupee(sp2_p_change_oi));
						$('#id_put_chng_oi_3').html(indianRupee(sp3_p_change_oi));
						
						$('#id_c_ltp_1').html(sp1_c_ltp);
						$('#id_c_ltp_2').html(sp2_c_ltp);
						$('#id_p_ltp_1').html(sp3_p_ltp);
						
						<!-- console.log($('#id_buy_ltp_2').html()); -->
						<!-- console.log(bearish_status); -->
						
						if (genimode_first_count == 0)
						{
							<!-- geniModeCalculation(); -->
							genimode_first_count = 1;
						}
						
						if (bullish_status == true)
						{
							var geni_sl_ltp = parseFloat($('#id_buy_ltp_1').html()) - 40;
							var geni_target_ltp = $('#id_buy_ltp_2').html();
							
							if (parseFloat(sp1_c_ltp) >= parseFloat(geni_target_ltp))
							{
								<!-- Update genimode_target_on here -->
								if (target == 0)
								{
									var selected_strike_price = parseInt($("#id_enter_strike_price_select option:selected").text());
									$.ajax({
										method: "POST",
										url: "/set_target_stop_loss/",
										data: {
											'edit_type':'target',
											'symbol':'BankNifty',
											'status':'On',
											'selected_strike_price': selected_strike_price,
										},
										success: function (response) 
										{			   
											if (response.status == '1'){}
											else{}
										}
									});
									$('#id_led_box').show();
									$('#id_led_box_2').hide();
									target = 1;
									stop_loss = 0;
								}
							}
							else if (parseFloat(sp1_c_ltp) < geni_sl_ltp )
							{
								if (stop_loss == 0)
								{
									var selected_strike_price = parseInt($("#id_enter_strike_price_select option:selected").text());
									$.ajax({
										method: "POST",
										url: "/set_target_stop_loss/",
										data: {
											'edit_type':'stop loss',
											'symbol':'BankNifty',
											'status':'On',
											'selected_strike_price': selected_strike_price,
										},
										success: function (response) 
										{			   
											if (response.status == '1'){}
											else{}
										}
									});
									$('#id_led_box_2').show();
									$('#id_led_box').hide();
									target = 0;
									stop_loss = 1;
								}
							}
						}
						else if (bearish_status == true)
						{
							var geni_sl_ltp = parseFloat($('#id_buy_ltp_1').html()) - 40;
							var geni_target_ltp = $('#id_buy_ltp_2').html();
							
							if (parseFloat(sp3_p_ltp) >= parseFloat(geni_target_ltp))
							{
								var selected_strike_price = parseInt($("#id_enter_strike_price_select option:selected").text());
								$.ajax({
									method: "POST",
									url: "/set_target_stop_loss/",
									data: {
										'edit_type':'target',
										'symbol':'BankNifty',
										'status':'On',
										'selected_strike_price': selected_strike_price,
									},
									success: function (response) 
									{			   
										if (response.status == '1'){}
										else{}
									}
								});
								
								if (target1 == 0)
								{
									$('#id_led_box').show();
									$('#id_led_box_2').hide();
									target1 = 1;
									stop_loss1= 0;
									other_target = 0;
								}									
							}
							else if (parseFloat(sp3_p_ltp) < geni_sl_ltp )
							{
								var selected_strike_price = parseInt($("#id_enter_strike_price_select option:selected").text());
								$.ajax({
									method: "POST",
									url: "/set_target_stop_loss/",
									data: {
										'edit_type':'stop loss',
										'symbol':'BankNifty',
										'status':'On',
										'selected_strike_price': selected_strike_price,
									},
									success: function (response) 
									{			   
										if (response.status == '1'){}
										else{}
									}
								});
								
								if (stop_loss1 == 0)
								{
									$('#id_led_box_2').show();
									$('#id_led_box').hide();
									target1 = 0;
									stop_loss1 = 1;
									other_target = 0;
								}
							}
						}
						else if (other_status == true)
						{
							var selected_strike_price = parseInt($("#id_enter_strike_price_select option:selected").text());
							$.ajax({
								method: "POST",
								url: "/set_target_stop_loss/",
								data: {
									'edit_type':'',
									'symbol':'BankNifty',
									'status':'Off',
									'selected_strike_price': selected_strike_price,
								},
								success: function (response) 
								{			   
									if (response.status == '1'){}
									else{}
								}
							});
							
							if (other_target == 0)
							{
								$('#id_led_box').hide();
								$('#id_led_box_2').hide();
								other_target = 1;
								target = 0;
								target1 = 0;
								stop_loss = 0;
								stop_loss1 = 0;
							}
						}
						
						$('#id_total_call_chng_oi').html(indianRupee(parseInt(sp1_c_change_oi) + parseInt(sp2_c_change_oi) + parseInt(sp3_c_change_oi)));
						$('#id_total_put_chng_oi').html(indianRupee(parseInt(sp1_p_change_oi) + parseInt(sp2_p_change_oi) + parseInt(sp3_p_change_oi)));
						<!-- $('#id_total_ltp').html((parseFloat(sp1_c_ltp) + parseFloat(sp2_c_ltp) + parseFloat(sp3_p_ltp)).toFixed(2)); -->
						

						$('#id_call_strike_price').html(indianRupee(max_call_oi_row.strike));
						$('#id_call_oi').html(indianRupee(max_call_oi_row.oi));
						$('#id_call_volume').html(indianRupee(parseFloat(max_call_oi_row.ltq)));
						
						$('#id_put_strike_price').html(indianRupee(max_put_oi_row.strike));
						$('#id_put_oi').html(indianRupee(max_put_oi_row.oi));
						$('#id_put_volume').html(indianRupee(parseFloat(max_put_oi_row.ltq)));
						
						$('#id_call_change_strike_price').html(indianRupee(max_call_change_oi_row.strike));
						$('#id_call_change_oi').html(indianRupee(max_call_change_oi_row.oi_change));
						$('#id_call_change_volume').html(indianRupee(parseFloat(max_call_change_oi_row.ltq)));
						
						$('#id_put_change_strike_price').html(indianRupee(max_put_change_oi_row.strike));
						$('#id_put_change_oi').html(indianRupee(max_put_change_oi_row.oi_change));
						$('#id_put_change_volume').html(indianRupee(parseFloat(max_put_change_oi_row.ltq)));
						
						
					
					<!-- end option chain analysis -->
				}
			}
		}
		createApp(CoinsApp).mount('#app');

		
</script>								
		 

{% include "Panel/footer.html" %}				 